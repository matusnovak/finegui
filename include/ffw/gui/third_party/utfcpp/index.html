<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>UTF8-CPP: UTF-8 with C++ in a Portable Way | FineGui</title>
    <meta name="description" content="A simple graphical user interface that allows you to use your own rendering engine">
    
    
    <link rel="preload" href="/finegui/assets/css/0.styles.8f9f42bf.css" as="style"><link rel="preload" href="/finegui/assets/js/app.3e08543b.js" as="script"><link rel="preload" href="/finegui/assets/js/254.bca2fd4e.js" as="script"><link rel="prefetch" href="/finegui/assets/js/10.f2b43712.js"><link rel="prefetch" href="/finegui/assets/js/100.b3fb5f38.js"><link rel="prefetch" href="/finegui/assets/js/101.996245cd.js"><link rel="prefetch" href="/finegui/assets/js/102.83687d3d.js"><link rel="prefetch" href="/finegui/assets/js/103.b5ef8757.js"><link rel="prefetch" href="/finegui/assets/js/104.a9ac2973.js"><link rel="prefetch" href="/finegui/assets/js/105.5448e2de.js"><link rel="prefetch" href="/finegui/assets/js/106.4261071c.js"><link rel="prefetch" href="/finegui/assets/js/107.e34fc1a0.js"><link rel="prefetch" href="/finegui/assets/js/108.990bab7c.js"><link rel="prefetch" href="/finegui/assets/js/109.15db87ed.js"><link rel="prefetch" href="/finegui/assets/js/11.9a0067cc.js"><link rel="prefetch" href="/finegui/assets/js/110.ca1b1328.js"><link rel="prefetch" href="/finegui/assets/js/111.4651b8b7.js"><link rel="prefetch" href="/finegui/assets/js/112.e24713a7.js"><link rel="prefetch" href="/finegui/assets/js/113.5d8e4c65.js"><link rel="prefetch" href="/finegui/assets/js/114.77e531b6.js"><link rel="prefetch" href="/finegui/assets/js/115.47dc95f8.js"><link rel="prefetch" href="/finegui/assets/js/116.4b438f9c.js"><link rel="prefetch" href="/finegui/assets/js/117.511808c3.js"><link rel="prefetch" href="/finegui/assets/js/118.1d4c5264.js"><link rel="prefetch" href="/finegui/assets/js/119.0240bf72.js"><link rel="prefetch" href="/finegui/assets/js/12.3517d0b7.js"><link rel="prefetch" href="/finegui/assets/js/120.3529dcbd.js"><link rel="prefetch" href="/finegui/assets/js/121.609e3571.js"><link rel="prefetch" href="/finegui/assets/js/122.400f7dc0.js"><link rel="prefetch" href="/finegui/assets/js/123.3097dbf3.js"><link rel="prefetch" href="/finegui/assets/js/124.4fab3df2.js"><link rel="prefetch" href="/finegui/assets/js/125.bb48e82f.js"><link rel="prefetch" href="/finegui/assets/js/126.6844a2e5.js"><link rel="prefetch" href="/finegui/assets/js/127.4809f3f4.js"><link rel="prefetch" href="/finegui/assets/js/128.dbef1f19.js"><link rel="prefetch" href="/finegui/assets/js/129.3068a63f.js"><link rel="prefetch" href="/finegui/assets/js/13.90baf2f7.js"><link rel="prefetch" href="/finegui/assets/js/130.3a3814e8.js"><link rel="prefetch" href="/finegui/assets/js/131.b159c8c2.js"><link rel="prefetch" href="/finegui/assets/js/132.96080e14.js"><link rel="prefetch" href="/finegui/assets/js/133.9272afc5.js"><link rel="prefetch" href="/finegui/assets/js/134.7691f376.js"><link rel="prefetch" href="/finegui/assets/js/135.d3c06712.js"><link rel="prefetch" href="/finegui/assets/js/136.e59dc6c2.js"><link rel="prefetch" href="/finegui/assets/js/137.aa7b60d2.js"><link rel="prefetch" href="/finegui/assets/js/138.f612826e.js"><link rel="prefetch" href="/finegui/assets/js/139.806d43b9.js"><link rel="prefetch" href="/finegui/assets/js/14.87612975.js"><link rel="prefetch" href="/finegui/assets/js/140.b3a022c8.js"><link rel="prefetch" href="/finegui/assets/js/141.e3558b3b.js"><link rel="prefetch" href="/finegui/assets/js/142.287310c8.js"><link rel="prefetch" href="/finegui/assets/js/143.ac4f9ed5.js"><link rel="prefetch" href="/finegui/assets/js/144.81776dd5.js"><link rel="prefetch" href="/finegui/assets/js/145.be148ff7.js"><link rel="prefetch" href="/finegui/assets/js/146.bc98e8e1.js"><link rel="prefetch" href="/finegui/assets/js/147.3b8363df.js"><link rel="prefetch" href="/finegui/assets/js/148.eee968ba.js"><link rel="prefetch" href="/finegui/assets/js/149.84725dc4.js"><link rel="prefetch" href="/finegui/assets/js/15.14104dc6.js"><link rel="prefetch" href="/finegui/assets/js/150.effa2794.js"><link rel="prefetch" href="/finegui/assets/js/151.49e7f2d0.js"><link rel="prefetch" href="/finegui/assets/js/152.2e2ea9be.js"><link rel="prefetch" href="/finegui/assets/js/153.d50c8efd.js"><link rel="prefetch" href="/finegui/assets/js/154.50915825.js"><link rel="prefetch" href="/finegui/assets/js/155.274d69e2.js"><link rel="prefetch" href="/finegui/assets/js/156.8a7a9202.js"><link rel="prefetch" href="/finegui/assets/js/157.cb7fa964.js"><link rel="prefetch" href="/finegui/assets/js/158.94d06cc1.js"><link rel="prefetch" href="/finegui/assets/js/159.9afb3056.js"><link rel="prefetch" href="/finegui/assets/js/16.746e8886.js"><link rel="prefetch" href="/finegui/assets/js/160.65cab18c.js"><link rel="prefetch" href="/finegui/assets/js/161.82af5083.js"><link rel="prefetch" href="/finegui/assets/js/162.70724438.js"><link rel="prefetch" href="/finegui/assets/js/163.4ad694bd.js"><link rel="prefetch" href="/finegui/assets/js/164.8db9c5c9.js"><link rel="prefetch" href="/finegui/assets/js/165.31023ede.js"><link rel="prefetch" href="/finegui/assets/js/166.2f6bf494.js"><link rel="prefetch" href="/finegui/assets/js/167.a85cd85d.js"><link rel="prefetch" href="/finegui/assets/js/168.c5e8ab22.js"><link rel="prefetch" href="/finegui/assets/js/169.c82352cf.js"><link rel="prefetch" href="/finegui/assets/js/17.8dacd3a0.js"><link rel="prefetch" href="/finegui/assets/js/170.5855e1e3.js"><link rel="prefetch" href="/finegui/assets/js/171.5096cd7d.js"><link rel="prefetch" href="/finegui/assets/js/172.ae85b067.js"><link rel="prefetch" href="/finegui/assets/js/173.409e82f8.js"><link rel="prefetch" href="/finegui/assets/js/174.e0830d8d.js"><link rel="prefetch" href="/finegui/assets/js/175.f0e535c2.js"><link rel="prefetch" href="/finegui/assets/js/176.cf2f510e.js"><link rel="prefetch" href="/finegui/assets/js/177.8bd76c9a.js"><link rel="prefetch" href="/finegui/assets/js/178.387606d9.js"><link rel="prefetch" href="/finegui/assets/js/179.0b65045a.js"><link rel="prefetch" href="/finegui/assets/js/18.b6697a0d.js"><link rel="prefetch" href="/finegui/assets/js/180.cb14e71d.js"><link rel="prefetch" href="/finegui/assets/js/181.e8ee6e64.js"><link rel="prefetch" href="/finegui/assets/js/182.fb65dea1.js"><link rel="prefetch" href="/finegui/assets/js/183.3ede84fa.js"><link rel="prefetch" href="/finegui/assets/js/184.fe0b44f3.js"><link rel="prefetch" href="/finegui/assets/js/185.90f2c505.js"><link rel="prefetch" href="/finegui/assets/js/186.670f49e8.js"><link rel="prefetch" href="/finegui/assets/js/187.ca2eec10.js"><link rel="prefetch" href="/finegui/assets/js/188.bd4d6499.js"><link rel="prefetch" href="/finegui/assets/js/189.466fe167.js"><link rel="prefetch" href="/finegui/assets/js/19.8e3b1ca0.js"><link rel="prefetch" href="/finegui/assets/js/190.0498ad96.js"><link rel="prefetch" href="/finegui/assets/js/191.6bae8286.js"><link rel="prefetch" href="/finegui/assets/js/192.1db65725.js"><link rel="prefetch" href="/finegui/assets/js/193.afe8290d.js"><link rel="prefetch" href="/finegui/assets/js/194.c4baf985.js"><link rel="prefetch" href="/finegui/assets/js/195.745f0b93.js"><link rel="prefetch" href="/finegui/assets/js/196.dd858565.js"><link rel="prefetch" href="/finegui/assets/js/197.847f4378.js"><link rel="prefetch" href="/finegui/assets/js/198.94555efd.js"><link rel="prefetch" href="/finegui/assets/js/199.0ccf8577.js"><link rel="prefetch" href="/finegui/assets/js/2.f797f101.js"><link rel="prefetch" href="/finegui/assets/js/20.32730d77.js"><link rel="prefetch" href="/finegui/assets/js/200.de70e1c5.js"><link rel="prefetch" href="/finegui/assets/js/201.57626015.js"><link rel="prefetch" href="/finegui/assets/js/202.27813b95.js"><link rel="prefetch" href="/finegui/assets/js/203.36a80504.js"><link rel="prefetch" href="/finegui/assets/js/204.e49d25ad.js"><link rel="prefetch" href="/finegui/assets/js/205.cb296008.js"><link rel="prefetch" href="/finegui/assets/js/206.ce728977.js"><link rel="prefetch" href="/finegui/assets/js/207.aa9dd486.js"><link rel="prefetch" href="/finegui/assets/js/208.02efb644.js"><link rel="prefetch" href="/finegui/assets/js/209.a66fafa5.js"><link rel="prefetch" href="/finegui/assets/js/21.2499d3ce.js"><link rel="prefetch" href="/finegui/assets/js/210.973e3c5f.js"><link rel="prefetch" href="/finegui/assets/js/211.84932e2f.js"><link rel="prefetch" href="/finegui/assets/js/212.54f71f07.js"><link rel="prefetch" href="/finegui/assets/js/213.9637a562.js"><link rel="prefetch" href="/finegui/assets/js/214.b63480e2.js"><link rel="prefetch" href="/finegui/assets/js/215.ac291d4e.js"><link rel="prefetch" href="/finegui/assets/js/216.e9dc86ce.js"><link rel="prefetch" href="/finegui/assets/js/217.86950e64.js"><link rel="prefetch" href="/finegui/assets/js/218.0797c967.js"><link rel="prefetch" href="/finegui/assets/js/219.18a0e804.js"><link rel="prefetch" href="/finegui/assets/js/22.beadf87e.js"><link rel="prefetch" href="/finegui/assets/js/220.38031964.js"><link rel="prefetch" href="/finegui/assets/js/221.8a658e49.js"><link rel="prefetch" href="/finegui/assets/js/222.db790df7.js"><link rel="prefetch" href="/finegui/assets/js/223.31340de1.js"><link rel="prefetch" href="/finegui/assets/js/224.3f61574a.js"><link rel="prefetch" href="/finegui/assets/js/225.bc633632.js"><link rel="prefetch" href="/finegui/assets/js/226.226798f7.js"><link rel="prefetch" href="/finegui/assets/js/227.9e8e5818.js"><link rel="prefetch" href="/finegui/assets/js/228.e1449843.js"><link rel="prefetch" href="/finegui/assets/js/229.f94b56f2.js"><link rel="prefetch" href="/finegui/assets/js/23.2773ab45.js"><link rel="prefetch" href="/finegui/assets/js/230.fec3cee2.js"><link rel="prefetch" href="/finegui/assets/js/231.b8de7219.js"><link rel="prefetch" href="/finegui/assets/js/232.9ce00ccb.js"><link rel="prefetch" href="/finegui/assets/js/233.402c2d27.js"><link rel="prefetch" href="/finegui/assets/js/234.55a4c3fa.js"><link rel="prefetch" href="/finegui/assets/js/235.cb66c4bc.js"><link rel="prefetch" href="/finegui/assets/js/236.30c151b1.js"><link rel="prefetch" href="/finegui/assets/js/237.a48bb447.js"><link rel="prefetch" href="/finegui/assets/js/238.1ea201ab.js"><link rel="prefetch" href="/finegui/assets/js/239.e7afe666.js"><link rel="prefetch" href="/finegui/assets/js/24.f6fe0150.js"><link rel="prefetch" href="/finegui/assets/js/240.55b5d1ee.js"><link rel="prefetch" href="/finegui/assets/js/241.8ccd2f12.js"><link rel="prefetch" href="/finegui/assets/js/242.a2e141e0.js"><link rel="prefetch" href="/finegui/assets/js/243.3d08dacc.js"><link rel="prefetch" href="/finegui/assets/js/244.f433246e.js"><link rel="prefetch" href="/finegui/assets/js/245.83d97714.js"><link rel="prefetch" href="/finegui/assets/js/246.9d67e148.js"><link rel="prefetch" href="/finegui/assets/js/247.2b41abd1.js"><link rel="prefetch" href="/finegui/assets/js/248.36c0f879.js"><link rel="prefetch" href="/finegui/assets/js/249.80b96e5e.js"><link rel="prefetch" href="/finegui/assets/js/25.73398518.js"><link rel="prefetch" href="/finegui/assets/js/250.65264763.js"><link rel="prefetch" href="/finegui/assets/js/251.77ed2590.js"><link rel="prefetch" href="/finegui/assets/js/252.418a6bde.js"><link rel="prefetch" href="/finegui/assets/js/253.f7dbcd31.js"><link rel="prefetch" href="/finegui/assets/js/255.b3a3ef21.js"><link rel="prefetch" href="/finegui/assets/js/26.e723ac80.js"><link rel="prefetch" href="/finegui/assets/js/27.5d038655.js"><link rel="prefetch" href="/finegui/assets/js/28.76bfeb86.js"><link rel="prefetch" href="/finegui/assets/js/29.479a91b9.js"><link rel="prefetch" href="/finegui/assets/js/3.a6ba528a.js"><link rel="prefetch" href="/finegui/assets/js/30.76cc75ab.js"><link rel="prefetch" href="/finegui/assets/js/31.1387d994.js"><link rel="prefetch" href="/finegui/assets/js/32.41970009.js"><link rel="prefetch" href="/finegui/assets/js/33.029871f7.js"><link rel="prefetch" href="/finegui/assets/js/34.968e1bc9.js"><link rel="prefetch" href="/finegui/assets/js/35.c6057a44.js"><link rel="prefetch" href="/finegui/assets/js/36.4e8d6691.js"><link rel="prefetch" href="/finegui/assets/js/37.2638cfe0.js"><link rel="prefetch" href="/finegui/assets/js/38.0890441c.js"><link rel="prefetch" href="/finegui/assets/js/39.14e051c3.js"><link rel="prefetch" href="/finegui/assets/js/4.bbf31126.js"><link rel="prefetch" href="/finegui/assets/js/40.1a2232a2.js"><link rel="prefetch" href="/finegui/assets/js/41.c8c614b4.js"><link rel="prefetch" href="/finegui/assets/js/42.f748fed9.js"><link rel="prefetch" href="/finegui/assets/js/43.7941f9ec.js"><link rel="prefetch" href="/finegui/assets/js/44.f1ab5b0b.js"><link rel="prefetch" href="/finegui/assets/js/45.668807f4.js"><link rel="prefetch" href="/finegui/assets/js/46.5d92e182.js"><link rel="prefetch" href="/finegui/assets/js/47.f16a07e9.js"><link rel="prefetch" href="/finegui/assets/js/48.ea53a291.js"><link rel="prefetch" href="/finegui/assets/js/49.1a6d2d5b.js"><link rel="prefetch" href="/finegui/assets/js/5.5f02c45b.js"><link rel="prefetch" href="/finegui/assets/js/50.1985a838.js"><link rel="prefetch" href="/finegui/assets/js/51.8aba91ec.js"><link rel="prefetch" href="/finegui/assets/js/52.f1d6806d.js"><link rel="prefetch" href="/finegui/assets/js/53.e69b9e15.js"><link rel="prefetch" href="/finegui/assets/js/54.16300f7b.js"><link rel="prefetch" href="/finegui/assets/js/55.f6cb755b.js"><link rel="prefetch" href="/finegui/assets/js/56.5cb81e6c.js"><link rel="prefetch" href="/finegui/assets/js/57.4e2c06b0.js"><link rel="prefetch" href="/finegui/assets/js/58.cf8423d2.js"><link rel="prefetch" href="/finegui/assets/js/59.70b9e961.js"><link rel="prefetch" href="/finegui/assets/js/6.d8d06794.js"><link rel="prefetch" href="/finegui/assets/js/60.43ff5848.js"><link rel="prefetch" href="/finegui/assets/js/61.721d56c2.js"><link rel="prefetch" href="/finegui/assets/js/62.18a0d672.js"><link rel="prefetch" href="/finegui/assets/js/63.d4ef3e62.js"><link rel="prefetch" href="/finegui/assets/js/64.eb1fca09.js"><link rel="prefetch" href="/finegui/assets/js/65.dffa9f52.js"><link rel="prefetch" href="/finegui/assets/js/66.f62dceb4.js"><link rel="prefetch" href="/finegui/assets/js/67.f9540851.js"><link rel="prefetch" href="/finegui/assets/js/68.e9baf36d.js"><link rel="prefetch" href="/finegui/assets/js/69.41d104a4.js"><link rel="prefetch" href="/finegui/assets/js/7.1d25bcd5.js"><link rel="prefetch" href="/finegui/assets/js/70.21f91d38.js"><link rel="prefetch" href="/finegui/assets/js/71.de6c5587.js"><link rel="prefetch" href="/finegui/assets/js/72.c29dd77f.js"><link rel="prefetch" href="/finegui/assets/js/73.8d6cd791.js"><link rel="prefetch" href="/finegui/assets/js/74.e6fd2cbc.js"><link rel="prefetch" href="/finegui/assets/js/75.39aad1d6.js"><link rel="prefetch" href="/finegui/assets/js/76.952ad292.js"><link rel="prefetch" href="/finegui/assets/js/77.d5f55609.js"><link rel="prefetch" href="/finegui/assets/js/78.39fbb271.js"><link rel="prefetch" href="/finegui/assets/js/79.766cfc6b.js"><link rel="prefetch" href="/finegui/assets/js/8.a22a1a07.js"><link rel="prefetch" href="/finegui/assets/js/80.136db699.js"><link rel="prefetch" href="/finegui/assets/js/81.f9b57f9e.js"><link rel="prefetch" href="/finegui/assets/js/82.b9e2e297.js"><link rel="prefetch" href="/finegui/assets/js/83.93eac250.js"><link rel="prefetch" href="/finegui/assets/js/84.60285735.js"><link rel="prefetch" href="/finegui/assets/js/85.c6bc63d2.js"><link rel="prefetch" href="/finegui/assets/js/86.917673b4.js"><link rel="prefetch" href="/finegui/assets/js/87.ea079258.js"><link rel="prefetch" href="/finegui/assets/js/88.89f1a242.js"><link rel="prefetch" href="/finegui/assets/js/89.2fbceea3.js"><link rel="prefetch" href="/finegui/assets/js/9.d262371d.js"><link rel="prefetch" href="/finegui/assets/js/90.b8ad7442.js"><link rel="prefetch" href="/finegui/assets/js/91.5b1a1ed5.js"><link rel="prefetch" href="/finegui/assets/js/92.f6bb24e3.js"><link rel="prefetch" href="/finegui/assets/js/93.f16d1dca.js"><link rel="prefetch" href="/finegui/assets/js/94.47a2fb96.js"><link rel="prefetch" href="/finegui/assets/js/95.240c758f.js"><link rel="prefetch" href="/finegui/assets/js/96.1da01f84.js"><link rel="prefetch" href="/finegui/assets/js/97.9f20a34d.js"><link rel="prefetch" href="/finegui/assets/js/98.4ac0bf8a.js"><link rel="prefetch" href="/finegui/assets/js/99.3e610d92.js">
    <link rel="stylesheet" href="/finegui/assets/css/0.styles.8f9f42bf.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/finegui/" class="home-link router-link-active"><!----> <span class="site-name">FineGui</span></a> <div class="links" style="max-width:nullpx;"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/finegui/" class="nav-link">Home</a></div><div class="nav-item"><a href="/finegui/INSTALL.html" class="nav-link">Install</a></div><div class="nav-item"><a href="/finegui/examples/" class="nav-link">Examples</a></div><div class="nav-item"><a href="/finegui/doxygen/modules.html" class="nav-link">Modules</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">Classes</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/finegui/doxygen/annotated.html" class="nav-link">Class List</a></li><li class="dropdown-item"><!----> <a href="/finegui/doxygen/classes.html" class="nav-link">Class Index</a></li><li class="dropdown-item"><!----> <a href="/finegui/doxygen/functions.html" class="nav-link">Function Index</a></li><li class="dropdown-item"><!----> <a href="/finegui/doxygen/variables.html" class="nav-link">Variable Index</a></li><li class="dropdown-item"><!----> <a href="/finegui/doxygen/enumerations.html" class="nav-link">Enumeration Index</a></li></ul></div></div><div class="nav-item"><a href="/finegui/doxygen/files.html" class="nav-link">Files</a></div><div class="nav-item"><a href="/finegui/doxygen/pages.html" class="nav-link">Pages</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/finegui/" class="nav-link">Home</a></div><div class="nav-item"><a href="/finegui/INSTALL.html" class="nav-link">Install</a></div><div class="nav-item"><a href="/finegui/examples/" class="nav-link">Examples</a></div><div class="nav-item"><a href="/finegui/doxygen/modules.html" class="nav-link">Modules</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">Classes</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/finegui/doxygen/annotated.html" class="nav-link">Class List</a></li><li class="dropdown-item"><!----> <a href="/finegui/doxygen/classes.html" class="nav-link">Class Index</a></li><li class="dropdown-item"><!----> <a href="/finegui/doxygen/functions.html" class="nav-link">Function Index</a></li><li class="dropdown-item"><!----> <a href="/finegui/doxygen/variables.html" class="nav-link">Variable Index</a></li><li class="dropdown-item"><!----> <a href="/finegui/doxygen/enumerations.html" class="nav-link">Enumeration Index</a></li></ul></div></div><div class="nav-item"><a href="/finegui/doxygen/files.html" class="nav-link">Files</a></div><div class="nav-item"><a href="/finegui/doxygen/pages.html" class="nav-link">Pages</a></div> <!----></nav>  <ul class="sidebar-links"><li><div class="sidebar-group first"><p class="sidebar-heading open"><span>UTF8-CPP: UTF-8 with C++ in a Portable Way</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/finegui/include/ffw/gui/third_party/utfcpp/#introduction" class="sidebar-link">Introduction</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/finegui/include/ffw/gui/third_party/utfcpp/#examples-of-use" class="sidebar-link">Examples of use</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/finegui/include/ffw/gui/third_party/utfcpp/#introductionary-sample" class="sidebar-link">Introductionary Sample</a></li><li class="sidebar-sub-header"><a href="/finegui/include/ffw/gui/third_party/utfcpp/#checking-if-a-file-contains-valid-utf-8-text" class="sidebar-link">Checking if a file contains valid UTF-8 text</a></li><li class="sidebar-sub-header"><a href="/finegui/include/ffw/gui/third_party/utfcpp/#ensure-that-a-string-contains-valid-utf-8-text" class="sidebar-link">Ensure that a string contains valid UTF-8 text</a></li></ul></li><li><a href="/finegui/include/ffw/gui/third_party/utfcpp/#reference" class="sidebar-link">Reference</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/finegui/include/ffw/gui/third_party/utfcpp/#functions-from-utf8-namespace" class="sidebar-link">Functions From utf8 Namespace</a></li><li class="sidebar-sub-header"><a href="/finegui/include/ffw/gui/third_party/utfcpp/#types-from-utf8-namespace" class="sidebar-link">Types From utf8 Namespace</a></li><li class="sidebar-sub-header"><a href="/finegui/include/ffw/gui/third_party/utfcpp/#functions-from-utf8-unchecked-namespace" class="sidebar-link">Functions From utf8::unchecked Namespace</a></li><li class="sidebar-sub-header"><a href="/finegui/include/ffw/gui/third_party/utfcpp/#types-from-utf8-unchecked-namespace" class="sidebar-link">Types From utf8::unchecked Namespace</a></li></ul></li><li><a href="/finegui/include/ffw/gui/third_party/utfcpp/#points-of-interest" class="sidebar-link">Points of interest</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/finegui/include/ffw/gui/third_party/utfcpp/#links" class="sidebar-link">Links</a><ul class="sidebar-sub-headers"></ul></li></ul></div></li></ul> </div> <div class="page"> <div class="content"><h1 id="utf8-cpp-utf-8-with-c-in-a-portable-way"><a href="#utf8-cpp-utf-8-with-c-in-a-portable-way" aria-hidden="true" class="header-anchor">#</a> UTF8-CPP: UTF-8 with C++ in a Portable Way</h1> <h2 id="introduction"><a href="#introduction" aria-hidden="true" class="header-anchor">#</a> Introduction</h2> <p>Many C++ developers miss an easy and portable way of handling Unicode encoded strings. The original C++ Standard (known as C++98 or C++03) is Unicode agnostic. C++11 provides some support for Unicode on core language and library level: u8, u, and U character and string literals, char16_t and char32_t character types, u16string and u32string library classes, and codecvt support for conversions between Unicode encoding forms. In the meantime, developers use third party libraries like ICU, OS specific capabilities, or simply roll out their own solutions.</p> <p>In order to easily handle UTF-8 encoded Unicode strings, I came up with a small, C++98 compatible generic library. For anybody used to work with STL algorithms and iterators, it should be easy and natural to use. The code is freely available for any purpose - check out the license at the beginning of the utf8.h file. The library has been used a lot in the past ten years both in commercial and open-source projects and is considered feature-complete now. If you run into bugs or performance issues, please let me know and I'll do my best to address them.</p> <p>The purpose of this article is not to offer an introduction to Unicode in general, and UTF-8 in particular. If you are not familiar with Unicode, be sure to check out <a href="http://www.unicode.org/" target="_blank" rel="noopener noreferrer">Unicode Home Page<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> or some other source of information for Unicode. Also, it is not my aim to advocate the use of UTF-8 encoded strings in C++ programs; if you want to handle UTF-8 encoded strings from C++, I am sure you have good reasons for it.</p> <h2 id="examples-of-use"><a href="#examples-of-use" aria-hidden="true" class="header-anchor">#</a> Examples of use</h2> <h3 id="introductionary-sample"><a href="#introductionary-sample" aria-hidden="true" class="header-anchor">#</a> Introductionary Sample</h3> <p>To illustrate the use of the library, let's start with a small but complete program that opens a file containing UTF-8 encoded text, reads it line by line, checks each line for invalid UTF-8 byte sequences, and converts it to UTF-16 encoding and back to UTF-8:</p> <div class="language-cpp extra-class"><pre class="language-cpp"><code><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;fstream&gt;</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;iostream&gt;</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;string&gt;</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;vector&gt;</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&quot;utf8.h&quot;</span></span>
<span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span>
<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">int</span> argc<span class="token punctuation">,</span> <span class="token keyword">char</span><span class="token operator">*</span><span class="token operator">*</span> argv<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>argc <span class="token operator">!=</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;\nUsage: docsample filename\n&quot;</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">const</span> <span class="token keyword">char</span><span class="token operator">*</span> test_file_path <span class="token operator">=</span> argv<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token comment">// Open the test file (contains UTF-8 encoded text)</span>
    ifstream <span class="token function">fs8</span><span class="token punctuation">(</span>test_file_path<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>fs8<span class="token punctuation">.</span><span class="token function">is_open</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;Could not open &quot;</span> <span class="token operator">&lt;&lt;</span> test_file_path <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">unsigned</span> line_count <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    string line<span class="token punctuation">;</span>
    <span class="token comment">// Play with all the lines in the file</span>
    <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token function">getline</span><span class="token punctuation">(</span>fs8<span class="token punctuation">,</span> line<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
       <span class="token comment">// check for invalid utf-8 (for a simple yes/no check, there is also utf8::is_valid function)</span>
        string<span class="token operator">::</span>iterator end_it <span class="token operator">=</span> utf8<span class="token operator">::</span><span class="token function">find_invalid</span><span class="token punctuation">(</span>line<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> line<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>end_it <span class="token operator">!=</span> line<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;Invalid UTF-8 encoding detected at line &quot;</span> <span class="token operator">&lt;&lt;</span> line_count <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;\n&quot;</span><span class="token punctuation">;</span>
            cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;This part is fine: &quot;</span> <span class="token operator">&lt;&lt;</span> <span class="token function">string</span><span class="token punctuation">(</span>line<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> end_it<span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;\n&quot;</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token comment">// Get the line length (at least for the valid part)</span>
        <span class="token keyword">int</span> length <span class="token operator">=</span> utf8<span class="token operator">::</span><span class="token function">distance</span><span class="token punctuation">(</span>line<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> end_it<span class="token punctuation">)</span><span class="token punctuation">;</span>
        cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;Length of line &quot;</span> <span class="token operator">&lt;&lt;</span> line_count <span class="token operator">&lt;&lt;</span> <span class="token string">&quot; is &quot;</span> <span class="token operator">&lt;&lt;</span> length <span class="token operator">&lt;&lt;</span>  <span class="token string">&quot;\n&quot;</span><span class="token punctuation">;</span>

        <span class="token comment">// Convert it to utf-16</span>
        vector<span class="token operator">&lt;</span><span class="token keyword">unsigned</span> <span class="token keyword">short</span><span class="token operator">&gt;</span> utf16line<span class="token punctuation">;</span>
        utf8<span class="token operator">::</span><span class="token function">utf8to16</span><span class="token punctuation">(</span>line<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> end_it<span class="token punctuation">,</span> <span class="token function">back_inserter</span><span class="token punctuation">(</span>utf16line<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// And back to utf-8</span>
        string utf8line<span class="token punctuation">;</span> 
        utf8<span class="token operator">::</span><span class="token function">utf16to8</span><span class="token punctuation">(</span>utf16line<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> utf16line<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">back_inserter</span><span class="token punctuation">(</span>utf8line<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// Confirm that the conversion went OK:</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>utf8line <span class="token operator">!=</span> <span class="token function">string</span><span class="token punctuation">(</span>line<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> end_it<span class="token punctuation">)</span><span class="token punctuation">)</span>
            cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;Error in UTF-16 conversion at line: &quot;</span> <span class="token operator">&lt;&lt;</span> line_count <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;\n&quot;</span><span class="token punctuation">;</span>        

        line_count<span class="token operator">++</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>In the previous code sample, for each line we performed a detection of invalid UTF-8 sequences with <code>find_invalid</code>; the number of characters (more precisely - the number of Unicode code points, including the end of line and even BOM if there is one) in each line was determined with a use of <code>utf8::distance</code>; finally, we have converted each line to UTF-16 encoding with <code>utf8to16</code> and back to UTF-8 with <code>utf16to8</code>.</p> <h3 id="checking-if-a-file-contains-valid-utf-8-text"><a href="#checking-if-a-file-contains-valid-utf-8-text" aria-hidden="true" class="header-anchor">#</a> Checking if a file contains valid UTF-8 text</h3> <p>Here is a function that checks whether the content of a file is valid UTF-8 encoded text without reading the content into the memory:</p> <div class="language-cpp extra-class"><pre class="language-cpp"><code><span class="token keyword">bool</span> <span class="token function">valid_utf8_file</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">char</span><span class="token operator">*</span> file_name<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    ifstream <span class="token function">ifs</span><span class="token punctuation">(</span>file_name<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>ifs<span class="token punctuation">)</span>
        <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span> <span class="token comment">// even better, throw here</span>

    istreambuf_iterator<span class="token operator">&lt;</span><span class="token keyword">char</span><span class="token operator">&gt;</span> <span class="token function">it</span><span class="token punctuation">(</span>ifs<span class="token punctuation">.</span><span class="token function">rdbuf</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    istreambuf_iterator<span class="token operator">&lt;</span><span class="token keyword">char</span><span class="token operator">&gt;</span> eos<span class="token punctuation">;</span>

    <span class="token keyword">return</span> utf8<span class="token operator">::</span><span class="token function">is_valid</span><span class="token punctuation">(</span>it<span class="token punctuation">,</span> eos<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>Because the function <code>utf8::is_valid()</code> works with input iterators, we were able to pass an <code>istreambuf_iterator</code> to it and read the content of the file directly without loading it to the memory first.</p> <p>Note that other functions that take input iterator arguments can be used in a similar way. For instance, to read the content of a UTF-8 encoded text file and convert the text to UTF-16, just do something like:</p> <div class="language-cpp extra-class"><pre class="language-cpp"><code>    utf8<span class="token operator">::</span><span class="token function">utf8to16</span><span class="token punctuation">(</span>it<span class="token punctuation">,</span> eos<span class="token punctuation">,</span> <span class="token function">back_inserter</span><span class="token punctuation">(</span>u16string<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="ensure-that-a-string-contains-valid-utf-8-text"><a href="#ensure-that-a-string-contains-valid-utf-8-text" aria-hidden="true" class="header-anchor">#</a> Ensure that a string contains valid UTF-8 text</h3> <p>If we have some text that &quot;probably&quot; contains UTF-8 encoded text and we want to replace any invalid UTF-8 sequence with a replacement character, something like the following function may be used:</p> <div class="language-cpp extra-class"><pre class="language-cpp"><code><span class="token keyword">void</span> <span class="token function">fix_utf8_string</span><span class="token punctuation">(</span>std<span class="token operator">::</span>string<span class="token operator">&amp;</span> str<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    std<span class="token operator">::</span>string temp<span class="token punctuation">;</span>
    utf8<span class="token operator">::</span><span class="token function">replace_invalid</span><span class="token punctuation">(</span>str<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> str<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">back_inserter</span><span class="token punctuation">(</span>temp<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    str <span class="token operator">=</span> temp<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>The function will replace any invalid UTF-8 sequence with a Unicode replacement character. There is an overloaded function that enables the caller to supply their own replacement character.</p> <h2 id="reference"><a href="#reference" aria-hidden="true" class="header-anchor">#</a> Reference</h2> <h3 id="functions-from-utf8-namespace"><a href="#functions-from-utf8-namespace" aria-hidden="true" class="header-anchor">#</a> Functions From utf8 Namespace</h3> <h4 id="utf8-append"><a href="#utf8-append" aria-hidden="true" class="header-anchor">#</a> utf8::append</h4> <p>Available in version 1.0 and later.</p> <p>Encodes a 32 bit code point as a UTF-8 sequence of octets and appends the sequence to a UTF-8 string.</p> <div class="language-cpp extra-class"><pre class="language-cpp"><code><span class="token keyword">template</span> <span class="token operator">&lt;</span><span class="token keyword">typename</span> octet_iterator<span class="token operator">&gt;</span>
octet_iterator <span class="token function">append</span><span class="token punctuation">(</span><span class="token keyword">uint32_t</span> cp<span class="token punctuation">,</span> octet_iterator result<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p><code>octet_iterator</code>: an output iterator.<br> <code>cp</code>: a 32 bit integer representing a code point to append to the sequence.<br> <code>result</code>: an output iterator to the place in the sequence where to append the code point.<br>
Return value: an iterator pointing to the place after the newly appended sequence.</p> <p>Example of use:</p> <div class="language-cpp extra-class"><pre class="language-cpp"><code><span class="token keyword">unsigned</span> <span class="token keyword">char</span> u<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">unsigned</span> <span class="token keyword">char</span><span class="token operator">*</span> end <span class="token operator">=</span> <span class="token function">append</span><span class="token punctuation">(</span><span class="token number">0x0448</span><span class="token punctuation">,</span> u<span class="token punctuation">)</span><span class="token punctuation">;</span>
assert <span class="token punctuation">(</span>u<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">0xd1</span> <span class="token operator">&amp;&amp;</span> u<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">0x88</span> <span class="token operator">&amp;&amp;</span> u<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">0</span> <span class="token operator">&amp;&amp;</span> u<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">0</span> <span class="token operator">&amp;&amp;</span> u<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Note that <code>append</code> does not allocate any memory - it is the burden of the caller to make sure there is enough memory allocated for the operation. To make things more interesting, <code>append</code> can add anywhere between 1 and 4 octets to the sequence. In practice, you would most often want to use <code>std::back_inserter</code> to ensure that the necessary memory is allocated.</p> <p>In case of an invalid code point, a <code>utf8::invalid_code_point</code> exception is thrown.</p> <h4 id="utf8-next"><a href="#utf8-next" aria-hidden="true" class="header-anchor">#</a> utf8::next</h4> <p>Available in version 1.0 and later.</p> <p>Given the iterator to the beginning of the UTF-8 sequence, it returns the code point and moves the iterator to the next position.</p> <div class="language-cpp extra-class"><pre class="language-cpp"><code><span class="token keyword">template</span> <span class="token operator">&lt;</span><span class="token keyword">typename</span> octet_iterator<span class="token operator">&gt;</span> 
<span class="token keyword">uint32_t</span> <span class="token function">next</span><span class="token punctuation">(</span>octet_iterator<span class="token operator">&amp;</span> it<span class="token punctuation">,</span> octet_iterator end<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p><code>octet_iterator</code>: an input iterator.<br> <code>it</code>: a reference to an iterator pointing to the beginning of an UTF-8 encoded code point. After the function returns, it is incremented to point to the beginning of the next code point.<br> <code>end</code>: end of the UTF-8 sequence to be processed. If <code>it</code> gets equal to <code>end</code> during the extraction of a code point, an <code>utf8::not_enough_room</code> exception is thrown.<br>
Return value: the 32 bit representation of the processed UTF-8 code point.</p> <p>Example of use:</p> <div class="language-cpp extra-class"><pre class="language-cpp"><code><span class="token keyword">char</span><span class="token operator">*</span> twochars <span class="token operator">=</span> <span class="token string">&quot;\xe6\x97\xa5\xd1\x88&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">char</span><span class="token operator">*</span> w <span class="token operator">=</span> twochars<span class="token punctuation">;</span>
<span class="token keyword">int</span> cp <span class="token operator">=</span> <span class="token function">next</span><span class="token punctuation">(</span>w<span class="token punctuation">,</span> twochars <span class="token operator">+</span> <span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
assert <span class="token punctuation">(</span>cp <span class="token operator">==</span> <span class="token number">0x65e5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
assert <span class="token punctuation">(</span>w <span class="token operator">==</span> twochars <span class="token operator">+</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>This function is typically used to iterate through a UTF-8 encoded string.</p> <p>In case of an invalid UTF-8 seqence, a <code>utf8::invalid_utf8</code> exception is thrown.</p> <h4 id="utf8-peek-next"><a href="#utf8-peek-next" aria-hidden="true" class="header-anchor">#</a> utf8::peek_next</h4> <p>Available in version 2.1 and later.</p> <p>Given the iterator to the beginning of the UTF-8 sequence, it returns the code point for the following sequence without changing the value of the iterator.</p> <div class="language-cpp extra-class"><pre class="language-cpp"><code><span class="token keyword">template</span> <span class="token operator">&lt;</span><span class="token keyword">typename</span> octet_iterator<span class="token operator">&gt;</span> 
<span class="token keyword">uint32_t</span> <span class="token function">peek_next</span><span class="token punctuation">(</span>octet_iterator it<span class="token punctuation">,</span> octet_iterator end<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p><code>octet_iterator</code>: an input iterator.<br> <code>it</code>: an iterator pointing to the beginning of an UTF-8 encoded code point.<br> <code>end</code>: end of the UTF-8 sequence to be processed. If <code>it</code> gets equal to <code>end</code> during the extraction of a code point, an <code>utf8::not_enough_room</code> exception is thrown.<br>
Return value: the 32 bit representation of the processed UTF-8 code point.</p> <p>Example of use:</p> <div class="language-cpp extra-class"><pre class="language-cpp"><code><span class="token keyword">char</span><span class="token operator">*</span> twochars <span class="token operator">=</span> <span class="token string">&quot;\xe6\x97\xa5\xd1\x88&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">char</span><span class="token operator">*</span> w <span class="token operator">=</span> twochars<span class="token punctuation">;</span>
<span class="token keyword">int</span> cp <span class="token operator">=</span> <span class="token function">peek_next</span><span class="token punctuation">(</span>w<span class="token punctuation">,</span> twochars <span class="token operator">+</span> <span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
assert <span class="token punctuation">(</span>cp <span class="token operator">==</span> <span class="token number">0x65e5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
assert <span class="token punctuation">(</span>w <span class="token operator">==</span> twochars<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>In case of an invalid UTF-8 seqence, a <code>utf8::invalid_utf8</code> exception is thrown.</p> <h4 id="utf8-prior"><a href="#utf8-prior" aria-hidden="true" class="header-anchor">#</a> utf8::prior</h4> <p>Available in version 1.02 and later.</p> <p>Given a reference to an iterator pointing to an octet in a UTF-8 sequence, it decreases the iterator until it hits the beginning of the previous UTF-8 encoded code point and returns the 32 bits representation of the code point.</p> <div class="language-cpp extra-class"><pre class="language-cpp"><code><span class="token keyword">template</span> <span class="token operator">&lt;</span><span class="token keyword">typename</span> octet_iterator<span class="token operator">&gt;</span> 
<span class="token keyword">uint32_t</span> <span class="token function">prior</span><span class="token punctuation">(</span>octet_iterator<span class="token operator">&amp;</span> it<span class="token punctuation">,</span> octet_iterator start<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p><code>octet_iterator</code>: a bidirectional iterator.<br> <code>it</code>: a reference pointing to an octet within a UTF-8 encoded string. After the function returns, it is decremented to point to the beginning of the previous code point.<br> <code>start</code>: an iterator to the beginning of the sequence where the search for the beginning of a code point is performed. It is a safety measure to prevent passing the beginning of the string in the search for a UTF-8 lead octet.<br>
Return value: the 32 bit representation of the previous code point.</p> <p>Example of use:</p> <div class="language-cpp extra-class"><pre class="language-cpp"><code><span class="token keyword">char</span><span class="token operator">*</span> twochars <span class="token operator">=</span> <span class="token string">&quot;\xe6\x97\xa5\xd1\x88&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">unsigned</span> <span class="token keyword">char</span><span class="token operator">*</span> w <span class="token operator">=</span> twochars <span class="token operator">+</span> <span class="token number">3</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> cp <span class="token operator">=</span> prior <span class="token punctuation">(</span>w<span class="token punctuation">,</span> twochars<span class="token punctuation">)</span><span class="token punctuation">;</span>
assert <span class="token punctuation">(</span>cp <span class="token operator">==</span> <span class="token number">0x65e5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
assert <span class="token punctuation">(</span>w <span class="token operator">==</span> twochars<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>This function has two purposes: one is two iterate backwards through a UTF-8 encoded string. Note that it is usually a better idea to iterate forward instead, since <code>utf8::next</code> is faster. The second purpose is to find a beginning of a UTF-8 sequence if we have a random position within a string. Note that in that case <code>utf8::prior</code> may not detect an invalid UTF-8 sequence in some scenarios: for instance if there are superfluous trail octets, it will just skip them.</p> <p><code>it</code> will typically point to the beginning of a code point, and <code>start</code> will point to the beginning of the string to ensure we don't go backwards too far. <code>it</code> is decreased until it points to a lead UTF-8 octet, and then the UTF-8 sequence beginning with that octet is decoded to a 32 bit representation and returned.</p> <p>In case <code>start</code> is reached before a UTF-8 lead octet is hit, or if an invalid UTF-8 sequence is started by the lead octet, an <code>invalid_utf8</code> exception is thrown.</p> <p>In case <code>start</code> equals <code>it</code>, a <code>not_enough_room</code> exception is thrown.</p> <h4 id="utf8-previous"><a href="#utf8-previous" aria-hidden="true" class="header-anchor">#</a> utf8::previous</h4> <p>Deprecated in version 1.02 and later.</p> <p>Given a reference to an iterator pointing to an octet in a UTF-8 seqence, it decreases the iterator until it hits the beginning of the previous UTF-8 encoded code point and returns the 32 bits representation of the code point.</p> <div class="language-cpp extra-class"><pre class="language-cpp"><code><span class="token keyword">template</span> <span class="token operator">&lt;</span><span class="token keyword">typename</span> octet_iterator<span class="token operator">&gt;</span> 
<span class="token keyword">uint32_t</span> <span class="token function">previous</span><span class="token punctuation">(</span>octet_iterator<span class="token operator">&amp;</span> it<span class="token punctuation">,</span> octet_iterator pass_start<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p><code>octet_iterator</code>: a random access iterator.<br> <code>it</code>: a reference pointing to an octet within a UTF-8 encoded string. After the function returns, it is decremented to point to the beginning of the previous code point.<br> <code>pass_start</code>: an iterator to the point in the sequence where the search for the beginning of a code point is aborted if no result was reached. It is a safety measure to prevent passing the beginning of the string in the search for a UTF-8 lead octet.<br>
Return value: the 32 bit representation of the previous code point.</p> <p>Example of use:</p> <div class="language-cpp extra-class"><pre class="language-cpp"><code><span class="token keyword">char</span><span class="token operator">*</span> twochars <span class="token operator">=</span> <span class="token string">&quot;\xe6\x97\xa5\xd1\x88&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">unsigned</span> <span class="token keyword">char</span><span class="token operator">*</span> w <span class="token operator">=</span> twochars <span class="token operator">+</span> <span class="token number">3</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> cp <span class="token operator">=</span> previous <span class="token punctuation">(</span>w<span class="token punctuation">,</span> twochars <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
assert <span class="token punctuation">(</span>cp <span class="token operator">==</span> <span class="token number">0x65e5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
assert <span class="token punctuation">(</span>w <span class="token operator">==</span> twochars<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p><code>utf8::previous</code> is deprecated, and <code>utf8::prior</code> should be used instead, although the existing code can continue using this function. The problem is the parameter <code>pass_start</code> that points to the position just before the beginning of the sequence. Standard containers don't have the concept of &quot;pass start&quot; and the function can not be used with their iterators.</p> <p><code>it</code> will typically point to the beginning of a code point, and <code>pass_start</code> will point to the octet just before the beginning of the string to ensure we don't go backwards too far. <code>it</code> is decreased until it points to a lead UTF-8 octet, and then the UTF-8 sequence beginning with that octet is decoded to a 32 bit representation and returned.</p> <p>In case <code>pass_start</code> is reached before a UTF-8 lead octet is hit, or if an invalid UTF-8 sequence is started by the lead octet, an <code>invalid_utf8</code> exception is thrown</p> <h4 id="utf8-advance"><a href="#utf8-advance" aria-hidden="true" class="header-anchor">#</a> utf8::advance</h4> <p>Available in version 1.0 and later.</p> <p>Advances an iterator by the specified number of code points within an UTF-8 sequence.</p> <div class="language-cpp extra-class"><pre class="language-cpp"><code><span class="token keyword">template</span> <span class="token operator">&lt;</span><span class="token keyword">typename</span> octet_iterator<span class="token punctuation">,</span> <span class="token keyword">typename</span> distance_type<span class="token operator">&gt;</span> 
<span class="token keyword">void</span> advance <span class="token punctuation">(</span>octet_iterator<span class="token operator">&amp;</span> it<span class="token punctuation">,</span> distance_type n<span class="token punctuation">,</span> octet_iterator end<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p><code>octet_iterator</code>: an input iterator.<br> <code>distance_type</code>: an integral type convertible to <code>octet_iterator</code>'s difference type.<br> <code>it</code>: a reference to an iterator pointing to the beginning of an UTF-8 encoded code point. After the function returns, it is incremented to point to the nth following code point.<br> <code>n</code>: a positive integer that shows how many code points we want to advance.<br> <code>end</code>: end of the UTF-8 sequence to be processed. If <code>it</code> gets equal to <code>end</code> during the extraction of a code point, an <code>utf8::not_enough_room</code> exception is thrown.</p> <p>Example of use:</p> <div class="language-cpp extra-class"><pre class="language-cpp"><code><span class="token keyword">char</span><span class="token operator">*</span> twochars <span class="token operator">=</span> <span class="token string">&quot;\xe6\x97\xa5\xd1\x88&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">unsigned</span> <span class="token keyword">char</span><span class="token operator">*</span> w <span class="token operator">=</span> twochars<span class="token punctuation">;</span>
advance <span class="token punctuation">(</span>w<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> twochars <span class="token operator">+</span> <span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
assert <span class="token punctuation">(</span>w <span class="token operator">==</span> twochars <span class="token operator">+</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>This function works only &quot;forward&quot;. In case of a negative <code>n</code>, there is no effect.</p> <p>In case of an invalid code point, a <code>utf8::invalid_code_point</code> exception is thrown.</p> <h4 id="utf8-distance"><a href="#utf8-distance" aria-hidden="true" class="header-anchor">#</a> utf8::distance</h4> <p>Available in version 1.0 and later.</p> <p>Given the iterators to two UTF-8 encoded code points in a seqence, returns the number of code points between them.</p> <div class="language-cpp extra-class"><pre class="language-cpp"><code><span class="token keyword">template</span> <span class="token operator">&lt;</span><span class="token keyword">typename</span> octet_iterator<span class="token operator">&gt;</span> 
<span class="token keyword">typename</span> std<span class="token operator">::</span>iterator_traits<span class="token operator">&lt;</span>octet_iterator<span class="token operator">&gt;</span><span class="token operator">::</span>difference_type distance <span class="token punctuation">(</span>octet_iterator first<span class="token punctuation">,</span> octet_iterator last<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p><code>octet_iterator</code>: an input iterator.<br> <code>first</code>: an iterator to a beginning of a UTF-8 encoded code point.<br> <code>last</code>: an iterator to a &quot;post-end&quot; of the last UTF-8 encoded code point in the sequence we are trying to determine the length. It can be the beginning of a new code point, or not.<br>
Return value the distance between the iterators, in code points.</p> <p>Example of use:</p> <div class="language-cpp extra-class"><pre class="language-cpp"><code><span class="token keyword">char</span><span class="token operator">*</span> twochars <span class="token operator">=</span> <span class="token string">&quot;\xe6\x97\xa5\xd1\x88&quot;</span><span class="token punctuation">;</span>
size_t dist <span class="token operator">=</span> utf8<span class="token operator">::</span><span class="token function">distance</span><span class="token punctuation">(</span>twochars<span class="token punctuation">,</span> twochars <span class="token operator">+</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
assert <span class="token punctuation">(</span>dist <span class="token operator">==</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>This function is used to find the length (in code points) of a UTF-8 encoded string. The reason it is called <em>distance</em>, rather than, say, <em>length</em> is mainly because developers are used that <em>length</em> is an O(1) function. Computing the length of an UTF-8 string is a linear operation, and it looked better to model it after <code>std::distance</code> algorithm.</p> <p>In case of an invalid UTF-8 seqence, a <code>utf8::invalid_utf8</code> exception is thrown. If <code>last</code> does not point to the past-of-end of a UTF-8 seqence, a <code>utf8::not_enough_room</code> exception is thrown.</p> <h4 id="utf8-utf16to8"><a href="#utf8-utf16to8" aria-hidden="true" class="header-anchor">#</a> utf8::utf16to8</h4> <p>Available in version 1.0 and later.</p> <p>Converts a UTF-16 encoded string to UTF-8.</p> <div class="language-cpp extra-class"><pre class="language-cpp"><code><span class="token keyword">template</span> <span class="token operator">&lt;</span><span class="token keyword">typename</span> u16bit_iterator<span class="token punctuation">,</span> <span class="token keyword">typename</span> octet_iterator<span class="token operator">&gt;</span>
octet_iterator utf16to8 <span class="token punctuation">(</span>u16bit_iterator start<span class="token punctuation">,</span> u16bit_iterator end<span class="token punctuation">,</span> octet_iterator result<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p><code>u16bit_iterator</code>: an input iterator.<br> <code>octet_iterator</code>: an output iterator.<br> <code>start</code>: an iterator pointing to the beginning of the UTF-16 encoded string to convert.<br> <code>end</code>: an iterator pointing to pass-the-end of the UTF-16 encoded string to convert.<br> <code>result</code>: an output iterator to the place in the UTF-8 string where to append the result of conversion.<br>
Return value: An iterator pointing to the place after the appended UTF-8 string.</p> <p>Example of use:</p> <div class="language-cpp extra-class"><pre class="language-cpp"><code><span class="token keyword">unsigned</span> <span class="token keyword">short</span> utf16string<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token number">0x41</span><span class="token punctuation">,</span> <span class="token number">0x0448</span><span class="token punctuation">,</span> <span class="token number">0x65e5</span><span class="token punctuation">,</span> <span class="token number">0xd834</span><span class="token punctuation">,</span> <span class="token number">0xdd1e</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
vector<span class="token operator">&lt;</span><span class="token keyword">unsigned</span> <span class="token keyword">char</span><span class="token operator">&gt;</span> utf8result<span class="token punctuation">;</span>
<span class="token function">utf16to8</span><span class="token punctuation">(</span>utf16string<span class="token punctuation">,</span> utf16string <span class="token operator">+</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token function">back_inserter</span><span class="token punctuation">(</span>utf8result<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
assert <span class="token punctuation">(</span>utf8result<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    
</code></pre></div><p>In case of invalid UTF-16 sequence, a <code>utf8::invalid_utf16</code> exception is thrown.</p> <h4 id="utf8-utf8to16"><a href="#utf8-utf8to16" aria-hidden="true" class="header-anchor">#</a> utf8::utf8to16</h4> <p>Available in version 1.0 and later.</p> <p>Converts an UTF-8 encoded string to UTF-16</p> <div class="language-cpp extra-class"><pre class="language-cpp"><code><span class="token keyword">template</span> <span class="token operator">&lt;</span><span class="token keyword">typename</span> u16bit_iterator<span class="token punctuation">,</span> <span class="token keyword">typename</span> octet_iterator<span class="token operator">&gt;</span>
u16bit_iterator utf8to16 <span class="token punctuation">(</span>octet_iterator start<span class="token punctuation">,</span> octet_iterator end<span class="token punctuation">,</span> u16bit_iterator result<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p><code>octet_iterator</code>: an input iterator.<br> <code>u16bit_iterator</code>: an output iterator.<br> <code>start</code>: an iterator pointing to the beginning of the UTF-8 encoded string to convert. &lt; br /&gt; <code>end</code>: an iterator pointing to pass-the-end of the UTF-8 encoded string to convert.<br> <code>result</code>: an output iterator to the place in the UTF-16 string where to append the result of conversion.<br>
Return value: An iterator pointing to the place after the appended UTF-16 string.</p> <p>Example of use:</p> <div class="language-cpp extra-class"><pre class="language-cpp"><code><span class="token keyword">char</span> utf8_with_surrogates<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">&quot;\xe6\x97\xa5\xd1\x88\xf0\x9d\x84\x9e&quot;</span><span class="token punctuation">;</span>
vector <span class="token operator">&lt;</span><span class="token keyword">unsigned</span> <span class="token keyword">short</span><span class="token operator">&gt;</span> utf16result<span class="token punctuation">;</span>
<span class="token function">utf8to16</span><span class="token punctuation">(</span>utf8_with_surrogates<span class="token punctuation">,</span> utf8_with_surrogates <span class="token operator">+</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token function">back_inserter</span><span class="token punctuation">(</span>utf16result<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
assert <span class="token punctuation">(</span>utf16result<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
assert <span class="token punctuation">(</span>utf16result<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">0xd834</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
assert <span class="token punctuation">(</span>utf16result<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">0xdd1e</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>In case of an invalid UTF-8 seqence, a <code>utf8::invalid_utf8</code> exception is thrown. If <code>end</code> does not point to the past-of-end of a UTF-8 seqence, a <code>utf8::not_enough_room</code> exception is thrown.</p> <h4 id="utf8-utf32to8"><a href="#utf8-utf32to8" aria-hidden="true" class="header-anchor">#</a> utf8::utf32to8</h4> <p>Available in version 1.0 and later.</p> <p>Converts a UTF-32 encoded string to UTF-8.</p> <div class="language-cpp extra-class"><pre class="language-cpp"><code><span class="token keyword">template</span> <span class="token operator">&lt;</span><span class="token keyword">typename</span> octet_iterator<span class="token punctuation">,</span> <span class="token keyword">typename</span> u32bit_iterator<span class="token operator">&gt;</span>
octet_iterator utf32to8 <span class="token punctuation">(</span>u32bit_iterator start<span class="token punctuation">,</span> u32bit_iterator end<span class="token punctuation">,</span> octet_iterator result<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p><code>octet_iterator</code>: an output iterator.<br> <code>u32bit_iterator</code>: an input iterator.<br> <code>start</code>: an iterator pointing to the beginning of the UTF-32 encoded string to convert.<br> <code>end</code>: an iterator pointing to pass-the-end of the UTF-32 encoded string to convert.<br> <code>result</code>: an output iterator to the place in the UTF-8 string where to append the result of conversion.<br>
Return value: An iterator pointing to the place after the appended UTF-8 string.</p> <p>Example of use:</p> <div class="language- extra-class"><pre class="language-text"><code>int utf32string[] = {0x448, 0x65E5, 0x10346, 0};
vector&lt;unsigned char&gt; utf8result;
utf32to8(utf32string, utf32string + 3, back_inserter(utf8result));
assert (utf8result.size() == 9);
</code></pre></div><p>In case of invalid UTF-32 string, a <code>utf8::invalid_code_point</code> exception is thrown.</p> <h4 id="utf8-utf8to32"><a href="#utf8-utf8to32" aria-hidden="true" class="header-anchor">#</a> utf8::utf8to32</h4> <p>Available in version 1.0 and later.</p> <p>Converts a UTF-8 encoded string to UTF-32.</p> <div class="language-cpp extra-class"><pre class="language-cpp"><code><span class="token keyword">template</span> <span class="token operator">&lt;</span><span class="token keyword">typename</span> octet_iterator<span class="token punctuation">,</span> <span class="token keyword">typename</span> u32bit_iterator<span class="token operator">&gt;</span>
u32bit_iterator utf8to32 <span class="token punctuation">(</span>octet_iterator start<span class="token punctuation">,</span> octet_iterator end<span class="token punctuation">,</span> u32bit_iterator result<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p><code>octet_iterator</code>: an input iterator.<br> <code>u32bit_iterator</code>: an output iterator.<br> <code>start</code>: an iterator pointing to the beginning of the UTF-8 encoded string to convert.<br> <code>end</code>: an iterator pointing to pass-the-end of the UTF-8 encoded string to convert.<br> <code>result</code>: an output iterator to the place in the UTF-32 string where to append the result of conversion.<br>
Return value: An iterator pointing to the place after the appended UTF-32 string.</p> <p>Example of use:</p> <div class="language-cpp extra-class"><pre class="language-cpp"><code><span class="token keyword">char</span><span class="token operator">*</span> twochars <span class="token operator">=</span> <span class="token string">&quot;\xe6\x97\xa5\xd1\x88&quot;</span><span class="token punctuation">;</span>
vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">&gt;</span> utf32result<span class="token punctuation">;</span>
<span class="token function">utf8to32</span><span class="token punctuation">(</span>twochars<span class="token punctuation">,</span> twochars <span class="token operator">+</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token function">back_inserter</span><span class="token punctuation">(</span>utf32result<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
assert <span class="token punctuation">(</span>utf32result<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>In case of an invalid UTF-8 seqence, a <code>utf8::invalid_utf8</code> exception is thrown. If <code>end</code> does not point to the past-of-end of a UTF-8 seqence, a <code>utf8::not_enough_room</code> exception is thrown.</p> <h4 id="utf8-find-invalid"><a href="#utf8-find-invalid" aria-hidden="true" class="header-anchor">#</a> utf8::find_invalid</h4> <p>Available in version 1.0 and later.</p> <p>Detects an invalid sequence within a UTF-8 string.</p> <div class="language-cpp extra-class"><pre class="language-cpp"><code><span class="token keyword">template</span> <span class="token operator">&lt;</span><span class="token keyword">typename</span> octet_iterator<span class="token operator">&gt;</span> 
octet_iterator <span class="token function">find_invalid</span><span class="token punctuation">(</span>octet_iterator start<span class="token punctuation">,</span> octet_iterator end<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p><code>octet_iterator</code>: an input iterator.<br> <code>start</code>: an iterator pointing to the beginning of the UTF-8 string to test for validity.<br> <code>end</code>: an iterator pointing to pass-the-end of the UTF-8 string to test for validity.<br>
Return value: an iterator pointing to the first invalid octet in the UTF-8 string. In case none were found, equals <code>end</code>.</p> <p>Example of use:</p> <div class="language-cpp extra-class"><pre class="language-cpp"><code><span class="token keyword">char</span> utf_invalid<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">&quot;\xe6\x97\xa5\xd1\x88\xfa&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">char</span><span class="token operator">*</span> invalid <span class="token operator">=</span> <span class="token function">find_invalid</span><span class="token punctuation">(</span>utf_invalid<span class="token punctuation">,</span> utf_invalid <span class="token operator">+</span> <span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
assert <span class="token punctuation">(</span>invalid <span class="token operator">==</span> utf_invalid <span class="token operator">+</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>This function is typically used to make sure a UTF-8 string is valid before processing it with other functions. It is especially important to call it if before doing any of the <em>unchecked</em> operations on it.</p> <h4 id="utf8-is-valid"><a href="#utf8-is-valid" aria-hidden="true" class="header-anchor">#</a> utf8::is_valid</h4> <p>Available in version 1.0 and later.</p> <p>Checks whether a sequence of octets is a valid UTF-8 string.</p> <div class="language-cpp extra-class"><pre class="language-cpp"><code><span class="token keyword">template</span> <span class="token operator">&lt;</span><span class="token keyword">typename</span> octet_iterator<span class="token operator">&gt;</span> 
<span class="token keyword">bool</span> <span class="token function">is_valid</span><span class="token punctuation">(</span>octet_iterator start<span class="token punctuation">,</span> octet_iterator end<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p><code>octet_iterator</code>: an input iterator.<br> <code>start</code>: an iterator pointing to the beginning of the UTF-8 string to test for validity.<br> <code>end</code>: an iterator pointing to pass-the-end of the UTF-8 string to test for validity.<br>
Return value: <code>true</code> if the sequence is a valid UTF-8 string; <code>false</code> if not.</p> <p>Example of use:</p> <div class="language-cpp extra-class"><pre class="language-cpp"><code><span class="token keyword">char</span> utf_invalid<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">&quot;\xe6\x97\xa5\xd1\x88\xfa&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">bool</span> bvalid <span class="token operator">=</span> <span class="token function">is_valid</span><span class="token punctuation">(</span>utf_invalid<span class="token punctuation">,</span> utf_invalid <span class="token operator">+</span> <span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
assert <span class="token punctuation">(</span>bvalid <span class="token operator">==</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p><code>is_valid</code> is a shorthand for <code>find_invalid(start, end) == end;</code>. You may want to use it to make sure that a byte seqence is a valid UTF-8 string without the need to know where it fails if it is not valid.</p> <h4 id="utf8-replace-invalid"><a href="#utf8-replace-invalid" aria-hidden="true" class="header-anchor">#</a> utf8::replace_invalid</h4> <p>Available in version 2.0 and later.</p> <p>Replaces all invalid UTF-8 sequences within a string with a replacement marker.</p> <div class="language-cpp extra-class"><pre class="language-cpp"><code><span class="token keyword">template</span> <span class="token operator">&lt;</span><span class="token keyword">typename</span> octet_iterator<span class="token punctuation">,</span> <span class="token keyword">typename</span> output_iterator<span class="token operator">&gt;</span>
output_iterator <span class="token function">replace_invalid</span><span class="token punctuation">(</span>octet_iterator start<span class="token punctuation">,</span> octet_iterator end<span class="token punctuation">,</span> output_iterator out<span class="token punctuation">,</span> <span class="token keyword">uint32_t</span> replacement<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">template</span> <span class="token operator">&lt;</span><span class="token keyword">typename</span> octet_iterator<span class="token punctuation">,</span> <span class="token keyword">typename</span> output_iterator<span class="token operator">&gt;</span>
output_iterator <span class="token function">replace_invalid</span><span class="token punctuation">(</span>octet_iterator start<span class="token punctuation">,</span> octet_iterator end<span class="token punctuation">,</span> output_iterator out<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p><code>octet_iterator</code>: an input iterator.<br> <code>output_iterator</code>: an output iterator.<br> <code>start</code>: an iterator pointing to the beginning of the UTF-8 string to look for invalid UTF-8 sequences.<br> <code>end</code>: an iterator pointing to pass-the-end of the UTF-8 string to look for invalid UTF-8 sequences.<br> <code>out</code>: An output iterator to the range where the result of replacement is stored.<br> <code>replacement</code>: A Unicode code point for the replacement marker. The version without this parameter assumes the value <code>0xfffd</code><br>
Return value: An iterator pointing to the place after the UTF-8 string with replaced invalid sequences.</p> <p>Example of use:</p> <div class="language-cpp extra-class"><pre class="language-cpp"><code><span class="token keyword">char</span> invalid_sequence<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">&quot;a\x80\xe0\xa0\xc0\xaf\xed\xa0\x80z&quot;</span><span class="token punctuation">;</span>
vector<span class="token operator">&lt;</span><span class="token keyword">char</span><span class="token operator">&gt;</span> replace_invalid_result<span class="token punctuation">;</span>
replace_invalid <span class="token punctuation">(</span>invalid_sequence<span class="token punctuation">,</span> invalid_sequence <span class="token operator">+</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>invalid_sequence<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">back_inserter</span><span class="token punctuation">(</span>replace_invalid_result<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'?'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
bvalid <span class="token operator">=</span> <span class="token function">is_valid</span><span class="token punctuation">(</span>replace_invalid_result<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> replace_invalid_result<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
assert <span class="token punctuation">(</span>bvalid<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">char</span><span class="token operator">*</span> fixed_invalid_sequence <span class="token operator">=</span> <span class="token string">&quot;a????z&quot;</span><span class="token punctuation">;</span>
assert <span class="token punctuation">(</span>std<span class="token operator">::</span><span class="token function">equal</span><span class="token punctuation">(</span>replace_invalid_result<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> replace_invalid_result<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> fixed_invalid_sequence<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p><code>replace_invalid</code> does not perform in-place replacement of invalid sequences. Rather, it produces a copy of the original string with the invalid sequences replaced with a replacement marker. Therefore, <code>out</code> must not be in the <code>[start, end]</code> range.</p> <p>If <code>end</code> does not point to the past-of-end of a UTF-8 sequence, a <code>utf8::not_enough_room</code> exception is thrown.</p> <h4 id="utf8-starts-with-bom"><a href="#utf8-starts-with-bom" aria-hidden="true" class="header-anchor">#</a> utf8::starts_with_bom</h4> <p>Available in version 2.3 and later. Relaces deprecated <code>is_bom()</code> function.</p> <p>Checks whether an octet sequence starts with a UTF-8 byte order mark (BOM)</p> <div class="language-cpp extra-class"><pre class="language-cpp"><code><span class="token keyword">template</span> <span class="token operator">&lt;</span><span class="token keyword">typename</span> octet_iterator<span class="token operator">&gt;</span> 
<span class="token keyword">bool</span> starts_with_bom <span class="token punctuation">(</span>octet_iterator it<span class="token punctuation">,</span> octet_iterator end<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p><code>octet_iterator</code>: an input iterator.<br> <code>it</code>: beginning of the octet sequence to check<br> <code>end</code>: pass-end of the sequence to check<br>
Return value: <code>true</code> if the sequence starts with a UTF-8 byte order mark; <code>false</code> if not.</p> <p>Example of use:</p> <div class="language-cpp extra-class"><pre class="language-cpp"><code><span class="token keyword">unsigned</span> <span class="token keyword">char</span> byte_order_mark<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token number">0xef</span><span class="token punctuation">,</span> <span class="token number">0xbb</span><span class="token punctuation">,</span> <span class="token number">0xbf</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">bool</span> bbom <span class="token operator">=</span> <span class="token function">starts_with_bom</span><span class="token punctuation">(</span>byte_order_mark<span class="token punctuation">,</span> byte_order_mark <span class="token operator">+</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>byte_order_mark<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
assert <span class="token punctuation">(</span>bbom <span class="token operator">==</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>The typical use of this function is to check the first three bytes of a file. If they form the UTF-8 BOM, we want to skip them before processing the actual UTF-8 encoded text.</p> <h4 id="utf8-is-bom"><a href="#utf8-is-bom" aria-hidden="true" class="header-anchor">#</a> utf8::is_bom</h4> <p>Available in version 1.0 and later. Deprecated in version 2.3. <code>starts_with_bom()</code> should be used instead.</p> <p>Checks whether a sequence of three octets is a UTF-8 byte order mark (BOM)</p> <div class="language-cpp extra-class"><pre class="language-cpp"><code><span class="token keyword">template</span> <span class="token operator">&lt;</span><span class="token keyword">typename</span> octet_iterator<span class="token operator">&gt;</span> 
<span class="token keyword">bool</span> is_bom <span class="token punctuation">(</span>octet_iterator it<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// Deprecated</span>
</code></pre></div><p><code>octet_iterator</code>: an input iterator.<br> <code>it</code>: beginning of the 3-octet sequence to check<br>
Return value: <code>true</code> if the sequence is UTF-8 byte order mark; <code>false</code> if not.</p> <p>Example of use:</p> <div class="language-cpp extra-class"><pre class="language-cpp"><code><span class="token keyword">unsigned</span> <span class="token keyword">char</span> byte_order_mark<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token number">0xef</span><span class="token punctuation">,</span> <span class="token number">0xbb</span><span class="token punctuation">,</span> <span class="token number">0xbf</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">bool</span> bbom <span class="token operator">=</span> <span class="token function">is_bom</span><span class="token punctuation">(</span>byte_order_mark<span class="token punctuation">)</span><span class="token punctuation">;</span>
assert <span class="token punctuation">(</span>bbom <span class="token operator">==</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>The typical use of this function is to check the first three bytes of a file. If they form the UTF-8 BOM, we want to skip them before processing the actual UTF-8 encoded text.</p> <p>If a sequence is shorter than three bytes, an invalid iterator will be dereferenced. Therefore, this function is deprecated in favor of <code>starts_with_bom()</code>that takes the end of sequence as an argument.</p> <h3 id="types-from-utf8-namespace"><a href="#types-from-utf8-namespace" aria-hidden="true" class="header-anchor">#</a> Types From utf8 Namespace</h3> <h4 id="utf8-exception"><a href="#utf8-exception" aria-hidden="true" class="header-anchor">#</a> utf8::exception</h4> <p>Available in version 2.3 and later.</p> <p>Base class for the exceptions thrown by UTF CPP library functions.</p> <div class="language-cpp extra-class"><pre class="language-cpp"><code><span class="token keyword">class</span> <span class="token class-name">exception</span> <span class="token operator">:</span> <span class="token keyword">public</span> std<span class="token operator">::</span>exception <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><p>Example of use:</p> <div class="language-cpp extra-class"><pre class="language-cpp"><code><span class="token keyword">try</span> <span class="token punctuation">{</span>
  <span class="token function">code_that_uses_utf_cpp_library</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">catch</span><span class="token punctuation">(</span><span class="token keyword">const</span> utf8<span class="token operator">::</span>exception<span class="token operator">&amp;</span> utfcpp_ex<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  cerr <span class="token operator">&lt;&lt;</span> utfcpp_ex<span class="token punctuation">.</span><span class="token function">what</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h4 id="utf8-invalid-code-point"><a href="#utf8-invalid-code-point" aria-hidden="true" class="header-anchor">#</a> utf8::invalid_code_point</h4> <p>Available in version 1.0 and later.</p> <p>Thrown by UTF8 CPP functions such as <code>advance</code> and <code>next</code> if an UTF-8 sequence represents and invalid code point.</p> <div class="language-cpp extra-class"><pre class="language-cpp"><code><span class="token keyword">class</span> <span class="token class-name">invalid_code_point</span> <span class="token operator">:</span> <span class="token keyword">public</span> exception <span class="token punctuation">{</span>
<span class="token keyword">public</span><span class="token operator">:</span> 
    <span class="token keyword">uint32_t</span> <span class="token function">code_point</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><p>Member function <code>code_point()</code> can be used to determine the invalid code point that caused the exception to be thrown.</p> <h4 id="utf8-invalid-utf8"><a href="#utf8-invalid-utf8" aria-hidden="true" class="header-anchor">#</a> utf8::invalid_utf8</h4> <p>Available in version 1.0 and later.</p> <p>Thrown by UTF8 CPP functions such as <code>next</code> and <code>prior</code> if an invalid UTF-8 sequence is detected during decoding.</p> <div class="language-cpp extra-class"><pre class="language-cpp"><code><span class="token keyword">class</span> <span class="token class-name">invalid_utf8</span> <span class="token operator">:</span> <span class="token keyword">public</span> exception <span class="token punctuation">{</span>
<span class="token keyword">public</span><span class="token operator">:</span> 
    <span class="token keyword">uint8_t</span> <span class="token function">utf8_octet</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><p>Member function <code>utf8_octet()</code> can be used to determine the beginning of the byte sequence that caused the exception to be thrown.</p> <h4 id="utf8-invalid-utf16"><a href="#utf8-invalid-utf16" aria-hidden="true" class="header-anchor">#</a> utf8::invalid_utf16</h4> <p>Available in version 1.0 and later.</p> <p>Thrown by UTF8 CPP function <code>utf16to8</code> if an invalid UTF-16 sequence is detected during decoding.</p> <div class="language-cpp extra-class"><pre class="language-cpp"><code><span class="token keyword">class</span> <span class="token class-name">invalid_utf16</span> <span class="token operator">:</span> <span class="token keyword">public</span> exception <span class="token punctuation">{</span>
<span class="token keyword">public</span><span class="token operator">:</span> 
    <span class="token keyword">uint16_t</span> <span class="token function">utf16_word</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><p>Member function <code>utf16_word()</code> can be used to determine the UTF-16 code unit that caused the exception to be thrown.</p> <h4 id="utf8-not-enough-room"><a href="#utf8-not-enough-room" aria-hidden="true" class="header-anchor">#</a> utf8::not_enough_room</h4> <p>Available in version 1.0 and later.</p> <p>Thrown by UTF8 CPP functions such as <code>next</code> if the end of the decoded UTF-8 sequence was reached before the code point was decoded.</p> <div class="language-cpp extra-class"><pre class="language-cpp"><code><span class="token keyword">class</span> <span class="token class-name">not_enough_room</span> <span class="token operator">:</span> <span class="token keyword">public</span> exception <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><h4 id="utf8-iterator"><a href="#utf8-iterator" aria-hidden="true" class="header-anchor">#</a> utf8::iterator</h4> <p>Available in version 2.0 and later.</p> <p>Adapts the underlying octet iterator to iterate over the sequence of code points, rather than raw octets.</p> <div class="language-cpp extra-class"><pre class="language-cpp"><code><span class="token keyword">template</span> <span class="token operator">&lt;</span><span class="token keyword">typename</span> octet_iterator<span class="token operator">&gt;</span>
<span class="token keyword">class</span> <span class="token class-name">iterator</span><span class="token punctuation">;</span>
</code></pre></div><h5 id="member-functions"><a href="#member-functions" aria-hidden="true" class="header-anchor">#</a> Member functions</h5> <p><code>iterator();</code> the deafult constructor; the underlying octet_iterator is constructed with its default constructor.
<code>explicit iterator (const octet_iterator&amp; octet_it, const octet_iterator&amp; range_start, const octet_iterator&amp; range_end);</code> a constructor that initializes the underlying octet_iterator with octet_it and sets the range in which the iterator is considered valid.
<code>octet_iterator base () const;</code> returns the underlying octet_iterator.
<code>uint32_t operator * () const;</code> decodes the utf-8 sequence the underlying octet_iterator is pointing to and returns the code point.
<code>bool operator == (const iterator&amp; rhs) const;</code> returns <code>true</code> if the two underlaying iterators are equal.
<code>bool operator != (const iterator&amp; rhs) const;</code> returns <code>true</code> if the two underlaying iterators are not equal.
<code>iterator&amp; operator ++ ();</code> the prefix increment - moves the iterator to the next UTF-8 encoded code point.
<code>iterator operator ++ (int);</code> the postfix increment - moves the iterator to the next UTF-8 encoded code point and returns the current one.
<code>iterator&amp; operator -- ();</code> the prefix decrement - moves the iterator to the previous UTF-8 encoded code point.
<code>iterator operator -- (int);</code> the postfix decrement - moves the iterator to the previous UTF-8 encoded code point and returns the current one.</p> <p>Example of use:</p> <div class="language-cpp extra-class"><pre class="language-cpp"><code><span class="token keyword">char</span><span class="token operator">*</span> threechars <span class="token operator">=</span> <span class="token string">&quot;\xf0\x90\x8d\x86\xe6\x97\xa5\xd1\x88&quot;</span><span class="token punctuation">;</span>
utf8<span class="token operator">::</span>iterator<span class="token operator">&lt;</span><span class="token keyword">char</span><span class="token operator">*</span><span class="token operator">&gt;</span> <span class="token function">it</span><span class="token punctuation">(</span>threechars<span class="token punctuation">,</span> threechars<span class="token punctuation">,</span> threechars <span class="token operator">+</span> <span class="token number">9</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
utf8<span class="token operator">::</span>iterator<span class="token operator">&lt;</span><span class="token keyword">char</span><span class="token operator">*</span><span class="token operator">&gt;</span> it2 <span class="token operator">=</span> it<span class="token punctuation">;</span>
assert <span class="token punctuation">(</span>it2 <span class="token operator">==</span> it<span class="token punctuation">)</span><span class="token punctuation">;</span>
assert <span class="token punctuation">(</span><span class="token operator">*</span>it <span class="token operator">==</span> <span class="token number">0x10346</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
assert <span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token operator">++</span>it<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0x65e5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
assert <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token operator">*</span>it<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0x65e5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
assert <span class="token punctuation">(</span><span class="token operator">*</span>it <span class="token operator">==</span> <span class="token number">0x0448</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
assert <span class="token punctuation">(</span>it <span class="token operator">!=</span> it2<span class="token punctuation">)</span><span class="token punctuation">;</span>
utf8<span class="token operator">::</span>iterator<span class="token operator">&lt;</span><span class="token keyword">char</span><span class="token operator">*</span><span class="token operator">&gt;</span> endit <span class="token punctuation">(</span>threechars <span class="token operator">+</span> <span class="token number">9</span><span class="token punctuation">,</span> threechars<span class="token punctuation">,</span> threechars <span class="token operator">+</span> <span class="token number">9</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
assert <span class="token punctuation">(</span><span class="token operator">++</span>it <span class="token operator">==</span> endit<span class="token punctuation">)</span><span class="token punctuation">;</span>
assert <span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token operator">--</span>it<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0x0448</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
assert <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token operator">*</span>it<span class="token operator">--</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0x0448</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
assert <span class="token punctuation">(</span><span class="token operator">*</span>it <span class="token operator">==</span> <span class="token number">0x65e5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
assert <span class="token punctuation">(</span><span class="token operator">--</span>it <span class="token operator">==</span> utf8<span class="token operator">::</span>iterator<span class="token operator">&lt;</span><span class="token keyword">char</span><span class="token operator">*</span><span class="token operator">&gt;</span><span class="token punctuation">(</span>threechars<span class="token punctuation">,</span> threechars<span class="token punctuation">,</span> threechars <span class="token operator">+</span> <span class="token number">9</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
assert <span class="token punctuation">(</span><span class="token operator">*</span>it <span class="token operator">==</span> <span class="token number">0x10346</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>The purpose of <code>utf8::iterator</code> adapter is to enable easy iteration as well as the use of STL algorithms with UTF-8 encoded strings. Increment and decrement operators are implemented in terms of <code>utf8::next()</code> and <code>utf8::prior()</code> functions.</p> <p>Note that <code>utf8::iterator</code> adapter is a checked iterator. It operates on the range specified in the constructor; any attempt to go out of that range will result in an exception. Even the comparison operators require both iterator object to be constructed against the same range - otherwise an exception is thrown. Typically, the range will be determined by sequence container functions <code>begin</code> and <code>end</code>, i.e.:</p> <div class="language-cpp extra-class"><pre class="language-cpp"><code>std<span class="token operator">::</span>string s <span class="token operator">=</span> <span class="token string">&quot;example&quot;</span><span class="token punctuation">;</span>
utf8<span class="token operator">::</span>iterator i <span class="token punctuation">(</span>s<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="functions-from-utf8-unchecked-namespace"><a href="#functions-from-utf8-unchecked-namespace" aria-hidden="true" class="header-anchor">#</a> Functions From utf8::unchecked Namespace</h3> <h4 id="utf8-unchecked-append"><a href="#utf8-unchecked-append" aria-hidden="true" class="header-anchor">#</a> utf8::unchecked::append</h4> <p>Available in version 1.0 and later.</p> <p>Encodes a 32 bit code point as a UTF-8 sequence of octets and appends the sequence to a UTF-8 string.</p> <div class="language-cpp extra-class"><pre class="language-cpp"><code><span class="token keyword">template</span> <span class="token operator">&lt;</span><span class="token keyword">typename</span> octet_iterator<span class="token operator">&gt;</span>
octet_iterator <span class="token function">append</span><span class="token punctuation">(</span><span class="token keyword">uint32_t</span> cp<span class="token punctuation">,</span> octet_iterator result<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p><code>cp</code>: A 32 bit integer representing a code point to append to the sequence.<br> <code>result</code>: An output iterator to the place in the sequence where to append the code point.<br>
Return value: An iterator pointing to the place after the newly appended sequence.</p> <p>Example of use:</p> <div class="language-cpp extra-class"><pre class="language-cpp"><code><span class="token keyword">unsigned</span> <span class="token keyword">char</span> u<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">unsigned</span> <span class="token keyword">char</span><span class="token operator">*</span> end <span class="token operator">=</span> unchecked<span class="token operator">::</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token number">0x0448</span><span class="token punctuation">,</span> u<span class="token punctuation">)</span><span class="token punctuation">;</span>
assert <span class="token punctuation">(</span>u<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">0xd1</span> <span class="token operator">&amp;&amp;</span> u<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">0x88</span> <span class="token operator">&amp;&amp;</span> u<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">0</span> <span class="token operator">&amp;&amp;</span> u<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">0</span> <span class="token operator">&amp;&amp;</span> u<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>This is a faster but less safe version of <code>utf8::append</code>. It does not check for validity of the supplied code point, and may produce an invalid UTF-8 sequence.</p> <h4 id="utf8-unchecked-next"><a href="#utf8-unchecked-next" aria-hidden="true" class="header-anchor">#</a> utf8::unchecked::next</h4> <p>Available in version 1.0 and later.</p> <p>Given the iterator to the beginning of a UTF-8 sequence, it returns the code point and moves the iterator to the next position.</p> <div class="language-cpp extra-class"><pre class="language-cpp"><code><span class="token keyword">template</span> <span class="token operator">&lt;</span><span class="token keyword">typename</span> octet_iterator<span class="token operator">&gt;</span>
<span class="token keyword">uint32_t</span> <span class="token function">next</span><span class="token punctuation">(</span>octet_iterator<span class="token operator">&amp;</span> it<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p><code>it</code>: a reference to an iterator pointing to the beginning of an UTF-8 encoded code point. After the function returns, it is incremented to point to the beginning of the next code point.<br>
Return value: the 32 bit representation of the processed UTF-8 code point.</p> <p>Example of use:</p> <div class="language-cpp extra-class"><pre class="language-cpp"><code><span class="token keyword">char</span><span class="token operator">*</span> twochars <span class="token operator">=</span> <span class="token string">&quot;\xe6\x97\xa5\xd1\x88&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">char</span><span class="token operator">*</span> w <span class="token operator">=</span> twochars<span class="token punctuation">;</span>
<span class="token keyword">int</span> cp <span class="token operator">=</span> unchecked<span class="token operator">::</span><span class="token function">next</span><span class="token punctuation">(</span>w<span class="token punctuation">)</span><span class="token punctuation">;</span>
assert <span class="token punctuation">(</span>cp <span class="token operator">==</span> <span class="token number">0x65e5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
assert <span class="token punctuation">(</span>w <span class="token operator">==</span> twochars <span class="token operator">+</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>This is a faster but less safe version of <code>utf8::next</code>. It does not check for validity of the supplied UTF-8 sequence.</p> <h4 id="utf8-unchecked-peek-next"><a href="#utf8-unchecked-peek-next" aria-hidden="true" class="header-anchor">#</a> utf8::unchecked::peek_next</h4> <p>Available in version 2.1 and later.</p> <p>Given the iterator to the beginning of a UTF-8 sequence, it returns the code point.</p> <div class="language-cpp extra-class"><pre class="language-cpp"><code><span class="token keyword">template</span> <span class="token operator">&lt;</span><span class="token keyword">typename</span> octet_iterator<span class="token operator">&gt;</span>
<span class="token keyword">uint32_t</span> <span class="token function">peek_next</span><span class="token punctuation">(</span>octet_iterator it<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p><code>it</code>: an iterator pointing to the beginning of an UTF-8 encoded code point.<br>
Return value: the 32 bit representation of the processed UTF-8 code point.</p> <p>Example of use:</p> <div class="language-cpp extra-class"><pre class="language-cpp"><code><span class="token keyword">char</span><span class="token operator">*</span> twochars <span class="token operator">=</span> <span class="token string">&quot;\xe6\x97\xa5\xd1\x88&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">char</span><span class="token operator">*</span> w <span class="token operator">=</span> twochars<span class="token punctuation">;</span>
<span class="token keyword">int</span> cp <span class="token operator">=</span> unchecked<span class="token operator">::</span><span class="token function">peek_next</span><span class="token punctuation">(</span>w<span class="token punctuation">)</span><span class="token punctuation">;</span>
assert <span class="token punctuation">(</span>cp <span class="token operator">==</span> <span class="token number">0x65e5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
assert <span class="token punctuation">(</span>w <span class="token operator">==</span> twochars<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>This is a faster but less safe version of <code>utf8::peek_next</code>. It does not check for validity of the supplied UTF-8 sequence.</p> <h4 id="utf8-unchecked-prior"><a href="#utf8-unchecked-prior" aria-hidden="true" class="header-anchor">#</a> utf8::unchecked::prior</h4> <p>Available in version 1.02 and later.</p> <p>Given a reference to an iterator pointing to an octet in a UTF-8 seqence, it decreases the iterator until it hits the beginning of the previous UTF-8 encoded code point and returns the 32 bits representation of the code point.</p> <div class="language-cpp extra-class"><pre class="language-cpp"><code><span class="token keyword">template</span> <span class="token operator">&lt;</span><span class="token keyword">typename</span> octet_iterator<span class="token operator">&gt;</span>
<span class="token keyword">uint32_t</span> <span class="token function">prior</span><span class="token punctuation">(</span>octet_iterator<span class="token operator">&amp;</span> it<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p><code>it</code>: a reference pointing to an octet within a UTF-8 encoded string. After the function returns, it is decremented to point to the beginning of the previous code point.<br>
Return value: the 32 bit representation of the previous code point.</p> <p>Example of use:</p> <div class="language-cpp extra-class"><pre class="language-cpp"><code><span class="token keyword">char</span><span class="token operator">*</span> twochars <span class="token operator">=</span> <span class="token string">&quot;\xe6\x97\xa5\xd1\x88&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">char</span><span class="token operator">*</span> w <span class="token operator">=</span> twochars <span class="token operator">+</span> <span class="token number">3</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> cp <span class="token operator">=</span> unchecked<span class="token operator">::</span>prior <span class="token punctuation">(</span>w<span class="token punctuation">)</span><span class="token punctuation">;</span>
assert <span class="token punctuation">(</span>cp <span class="token operator">==</span> <span class="token number">0x65e5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
assert <span class="token punctuation">(</span>w <span class="token operator">==</span> twochars<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>This is a faster but less safe version of <code>utf8::prior</code>. It does not check for validity of the supplied UTF-8 sequence and offers no boundary checking.</p> <h4 id="utf8-unchecked-previous-deprecated-see-utf8-unchecked-prior"><a href="#utf8-unchecked-previous-deprecated-see-utf8-unchecked-prior" aria-hidden="true" class="header-anchor">#</a> utf8::unchecked::previous (deprecated, see utf8::unchecked::prior)</h4> <p>Deprecated in version 1.02 and later.</p> <p>Given a reference to an iterator pointing to an octet in a UTF-8 seqence, it decreases the iterator until it hits the beginning of the previous UTF-8 encoded code point and returns the 32 bits representation of the code point.</p> <div class="language-cpp extra-class"><pre class="language-cpp"><code><span class="token keyword">template</span> <span class="token operator">&lt;</span><span class="token keyword">typename</span> octet_iterator<span class="token operator">&gt;</span>
<span class="token keyword">uint32_t</span> <span class="token function">previous</span><span class="token punctuation">(</span>octet_iterator<span class="token operator">&amp;</span> it<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p><code>it</code>: a reference pointing to an octet within a UTF-8 encoded string. After the function returns, it is decremented to point to the beginning of the previous code point.<br>
Return value: the 32 bit representation of the previous code point.</p> <p>Example of use:</p> <div class="language-cpp extra-class"><pre class="language-cpp"><code><span class="token keyword">char</span><span class="token operator">*</span> twochars <span class="token operator">=</span> <span class="token string">&quot;\xe6\x97\xa5\xd1\x88&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">char</span><span class="token operator">*</span> w <span class="token operator">=</span> twochars <span class="token operator">+</span> <span class="token number">3</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> cp <span class="token operator">=</span> unchecked<span class="token operator">::</span>previous <span class="token punctuation">(</span>w<span class="token punctuation">)</span><span class="token punctuation">;</span>
assert <span class="token punctuation">(</span>cp <span class="token operator">==</span> <span class="token number">0x65e5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
assert <span class="token punctuation">(</span>w <span class="token operator">==</span> twochars<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>The reason this function is deprecated is just the consistency with the &quot;checked&quot; versions, where <code>prior</code> should be used instead of <code>previous</code>. In fact, <code>unchecked::previous</code> behaves exactly the same as <code>unchecked::prior</code></p> <p>This is a faster but less safe version of <code>utf8::previous</code>. It does not check for validity of the supplied UTF-8 sequence and offers no boundary checking.</p> <h4 id="utf8-unchecked-advance"><a href="#utf8-unchecked-advance" aria-hidden="true" class="header-anchor">#</a> utf8::unchecked::advance</h4> <p>Available in version 1.0 and later.</p> <p>Advances an iterator by the specified number of code points within an UTF-8 sequence.</p> <div class="language-cpp extra-class"><pre class="language-cpp"><code><span class="token keyword">template</span> <span class="token operator">&lt;</span><span class="token keyword">typename</span> octet_iterator<span class="token punctuation">,</span> <span class="token keyword">typename</span> distance_type<span class="token operator">&gt;</span>
<span class="token keyword">void</span> advance <span class="token punctuation">(</span>octet_iterator<span class="token operator">&amp;</span> it<span class="token punctuation">,</span> distance_type n<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p><code>it</code>: a reference to an iterator pointing to the beginning of an UTF-8 encoded code point. After the function returns, it is incremented to point to the nth following code point.<br> <code>n</code>: a positive integer that shows how many code points we want to advance.</p> <p>Example of use:</p> <div class="language-cpp extra-class"><pre class="language-cpp"><code><span class="token keyword">char</span><span class="token operator">*</span> twochars <span class="token operator">=</span> <span class="token string">&quot;\xe6\x97\xa5\xd1\x88&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">char</span><span class="token operator">*</span> w <span class="token operator">=</span> twochars<span class="token punctuation">;</span>
unchecked<span class="token operator">::</span>advance <span class="token punctuation">(</span>w<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
assert <span class="token punctuation">(</span>w <span class="token operator">==</span> twochars <span class="token operator">+</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>This function works only &quot;forward&quot;. In case of a negative <code>n</code>, there is no effect.</p> <p>This is a faster but less safe version of <code>utf8::advance</code>. It does not check for validity of the supplied UTF-8 sequence and offers no boundary checking.</p> <h4 id="utf8-unchecked-distance"><a href="#utf8-unchecked-distance" aria-hidden="true" class="header-anchor">#</a> utf8::unchecked::distance</h4> <p>Available in version 1.0 and later.</p> <p>Given the iterators to two UTF-8 encoded code points in a seqence, returns the number of code points between them.</p> <div class="language-cpp extra-class"><pre class="language-cpp"><code><span class="token keyword">template</span> <span class="token operator">&lt;</span><span class="token keyword">typename</span> octet_iterator<span class="token operator">&gt;</span>
<span class="token keyword">typename</span> std<span class="token operator">::</span>iterator_traits<span class="token operator">&lt;</span>octet_iterator<span class="token operator">&gt;</span><span class="token operator">::</span>difference_type distance <span class="token punctuation">(</span>octet_iterator first<span class="token punctuation">,</span> octet_iterator last<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p><code>first</code>: an iterator to a beginning of a UTF-8 encoded code point.<br> <code>last</code>: an iterator to a &quot;post-end&quot; of the last UTF-8 encoded code point in the sequence we are trying to determine the length. It can be the beginning of a new code point, or not.<br>
Return value: the distance between the iterators, in code points.</p> <p>Example of use:</p> <div class="language-cpp extra-class"><pre class="language-cpp"><code><span class="token keyword">char</span><span class="token operator">*</span> twochars <span class="token operator">=</span> <span class="token string">&quot;\xe6\x97\xa5\xd1\x88&quot;</span><span class="token punctuation">;</span>
size_t dist <span class="token operator">=</span> utf8<span class="token operator">::</span>unchecked<span class="token operator">::</span><span class="token function">distance</span><span class="token punctuation">(</span>twochars<span class="token punctuation">,</span> twochars <span class="token operator">+</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
assert <span class="token punctuation">(</span>dist <span class="token operator">==</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>This is a faster but less safe version of <code>utf8::distance</code>. It does not check for validity of the supplied UTF-8 sequence.</p> <h4 id="utf8-unchecked-utf16to8"><a href="#utf8-unchecked-utf16to8" aria-hidden="true" class="header-anchor">#</a> utf8::unchecked::utf16to8</h4> <p>Available in version 1.0 and later.</p> <p>Converts a UTF-16 encoded string to UTF-8.</p> <div class="language-cpp extra-class"><pre class="language-cpp"><code><span class="token keyword">template</span> <span class="token operator">&lt;</span><span class="token keyword">typename</span> u16bit_iterator<span class="token punctuation">,</span> <span class="token keyword">typename</span> octet_iterator<span class="token operator">&gt;</span>
octet_iterator utf16to8 <span class="token punctuation">(</span>u16bit_iterator start<span class="token punctuation">,</span> u16bit_iterator end<span class="token punctuation">,</span> octet_iterator result<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p><code>start</code>: an iterator pointing to the beginning of the UTF-16 encoded string to convert.<br> <code>end</code>: an iterator pointing to pass-the-end of the UTF-16 encoded string to convert.<br> <code>result</code>: an output iterator to the place in the UTF-8 string where to append the result of conversion.<br>
Return value: An iterator pointing to the place after the appended UTF-8 string.</p> <p>Example of use:</p> <div class="language-cpp extra-class"><pre class="language-cpp"><code><span class="token keyword">unsigned</span> <span class="token keyword">short</span> utf16string<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token number">0x41</span><span class="token punctuation">,</span> <span class="token number">0x0448</span><span class="token punctuation">,</span> <span class="token number">0x65e5</span><span class="token punctuation">,</span> <span class="token number">0xd834</span><span class="token punctuation">,</span> <span class="token number">0xdd1e</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
vector<span class="token operator">&lt;</span><span class="token keyword">unsigned</span> <span class="token keyword">char</span><span class="token operator">&gt;</span> utf8result<span class="token punctuation">;</span>
unchecked<span class="token operator">::</span><span class="token function">utf16to8</span><span class="token punctuation">(</span>utf16string<span class="token punctuation">,</span> utf16string <span class="token operator">+</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token function">back_inserter</span><span class="token punctuation">(</span>utf8result<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
assert <span class="token punctuation">(</span>utf8result<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    
</code></pre></div><p>This is a faster but less safe version of <code>utf8::utf16to8</code>. It does not check for validity of the supplied UTF-16 sequence.</p> <h4 id="utf8-unchecked-utf8to16"><a href="#utf8-unchecked-utf8to16" aria-hidden="true" class="header-anchor">#</a> utf8::unchecked::utf8to16</h4> <p>Available in version 1.0 and later.</p> <p>Converts an UTF-8 encoded string to UTF-16</p> <div class="language-cpp extra-class"><pre class="language-cpp"><code><span class="token keyword">template</span> <span class="token operator">&lt;</span><span class="token keyword">typename</span> u16bit_iterator<span class="token punctuation">,</span> <span class="token keyword">typename</span> octet_iterator<span class="token operator">&gt;</span>
u16bit_iterator utf8to16 <span class="token punctuation">(</span>octet_iterator start<span class="token punctuation">,</span> octet_iterator end<span class="token punctuation">,</span> u16bit_iterator result<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p><code>start</code>: an iterator pointing to the beginning of the UTF-8 encoded string to convert. &lt; br /&gt; <code>end</code>: an iterator pointing to pass-the-end of the UTF-8 encoded string to convert.<br> <code>result</code>: an output iterator to the place in the UTF-16 string where to append the result of conversion.<br>
Return value: An iterator pointing to the place after the appended UTF-16 string.</p> <p>Example of use:</p> <div class="language-cpp extra-class"><pre class="language-cpp"><code><span class="token keyword">char</span> utf8_with_surrogates<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">&quot;\xe6\x97\xa5\xd1\x88\xf0\x9d\x84\x9e&quot;</span><span class="token punctuation">;</span>
vector <span class="token operator">&lt;</span><span class="token keyword">unsigned</span> <span class="token keyword">short</span><span class="token operator">&gt;</span> utf16result<span class="token punctuation">;</span>
unchecked<span class="token operator">::</span><span class="token function">utf8to16</span><span class="token punctuation">(</span>utf8_with_surrogates<span class="token punctuation">,</span> utf8_with_surrogates <span class="token operator">+</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token function">back_inserter</span><span class="token punctuation">(</span>utf16result<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
assert <span class="token punctuation">(</span>utf16result<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
assert <span class="token punctuation">(</span>utf16result<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">0xd834</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
assert <span class="token punctuation">(</span>utf16result<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">0xdd1e</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>This is a faster but less safe version of <code>utf8::utf8to16</code>. It does not check for validity of the supplied UTF-8 sequence.</p> <h4 id="utf8-unchecked-utf32to8"><a href="#utf8-unchecked-utf32to8" aria-hidden="true" class="header-anchor">#</a> utf8::unchecked::utf32to8</h4> <p>Available in version 1.0 and later.</p> <p>Converts a UTF-32 encoded string to UTF-8.</p> <div class="language-cpp extra-class"><pre class="language-cpp"><code><span class="token keyword">template</span> <span class="token operator">&lt;</span><span class="token keyword">typename</span> octet_iterator<span class="token punctuation">,</span> <span class="token keyword">typename</span> u32bit_iterator<span class="token operator">&gt;</span>
octet_iterator utf32to8 <span class="token punctuation">(</span>u32bit_iterator start<span class="token punctuation">,</span> u32bit_iterator end<span class="token punctuation">,</span> octet_iterator result<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p><code>start</code>: an iterator pointing to the beginning of the UTF-32 encoded string to convert.<br> <code>end</code>: an iterator pointing to pass-the-end of the UTF-32 encoded string to convert.<br> <code>result</code>: an output iterator to the place in the UTF-8 string where to append the result of conversion.<br>
Return value: An iterator pointing to the place after the appended UTF-8 string.</p> <p>Example of use:</p> <div class="language-cpp extra-class"><pre class="language-cpp"><code><span class="token keyword">int</span> utf32string<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token number">0x448</span><span class="token punctuation">,</span> <span class="token number">0x65e5</span><span class="token punctuation">,</span> <span class="token number">0x10346</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
vector<span class="token operator">&lt;</span><span class="token keyword">unsigned</span> <span class="token keyword">char</span><span class="token operator">&gt;</span> utf8result<span class="token punctuation">;</span>
<span class="token function">utf32to8</span><span class="token punctuation">(</span>utf32string<span class="token punctuation">,</span> utf32string <span class="token operator">+</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token function">back_inserter</span><span class="token punctuation">(</span>utf8result<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
assert <span class="token punctuation">(</span>utf8result<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">9</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>This is a faster but less safe version of <code>utf8::utf32to8</code>. It does not check for validity of the supplied UTF-32 sequence.</p> <h4 id="utf8-unchecked-utf8to32"><a href="#utf8-unchecked-utf8to32" aria-hidden="true" class="header-anchor">#</a> utf8::unchecked::utf8to32</h4> <p>Available in version 1.0 and later.</p> <p>Converts a UTF-8 encoded string to UTF-32.</p> <div class="language-cpp extra-class"><pre class="language-cpp"><code><span class="token keyword">template</span> <span class="token operator">&lt;</span><span class="token keyword">typename</span> octet_iterator<span class="token punctuation">,</span> <span class="token keyword">typename</span> u32bit_iterator<span class="token operator">&gt;</span>
u32bit_iterator utf8to32 <span class="token punctuation">(</span>octet_iterator start<span class="token punctuation">,</span> octet_iterator end<span class="token punctuation">,</span> u32bit_iterator result<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p><code>start</code>: an iterator pointing to the beginning of the UTF-8 encoded string to convert.<br> <code>end</code>: an iterator pointing to pass-the-end of the UTF-8 encoded string to convert.<br> <code>result</code>: an output iterator to the place in the UTF-32 string where to append the result of conversion.<br>
Return value: An iterator pointing to the place after the appended UTF-32 string.</p> <p>Example of use:</p> <div class="language-cpp extra-class"><pre class="language-cpp"><code><span class="token keyword">char</span><span class="token operator">*</span> twochars <span class="token operator">=</span> <span class="token string">&quot;\xe6\x97\xa5\xd1\x88&quot;</span><span class="token punctuation">;</span>
vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">&gt;</span> utf32result<span class="token punctuation">;</span>
unchecked<span class="token operator">::</span><span class="token function">utf8to32</span><span class="token punctuation">(</span>twochars<span class="token punctuation">,</span> twochars <span class="token operator">+</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token function">back_inserter</span><span class="token punctuation">(</span>utf32result<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
assert <span class="token punctuation">(</span>utf32result<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>This is a faster but less safe version of <code>utf8::utf8to32</code>. It does not check for validity of the supplied UTF-8 sequence.</p> <h3 id="types-from-utf8-unchecked-namespace"><a href="#types-from-utf8-unchecked-namespace" aria-hidden="true" class="header-anchor">#</a> Types From utf8::unchecked Namespace</h3> <h4 id="utf8-iterator-2"><a href="#utf8-iterator-2" aria-hidden="true" class="header-anchor">#</a> utf8::iterator</h4> <p>Available in version 2.0 and later.</p> <p>Adapts the underlying octet iterator to iterate over the sequence of code points, rather than raw octets.</p> <div class="language-cpp extra-class"><pre class="language-cpp"><code><span class="token keyword">template</span> <span class="token operator">&lt;</span><span class="token keyword">typename</span> octet_iterator<span class="token operator">&gt;</span>
<span class="token keyword">class</span> <span class="token class-name">iterator</span><span class="token punctuation">;</span>
</code></pre></div><h5 id="member-functions-2"><a href="#member-functions-2" aria-hidden="true" class="header-anchor">#</a> Member functions</h5> <p><code>iterator();</code> the deafult constructor; the underlying octet_iterator is constructed with its default constructor.
<code>explicit iterator (const octet_iterator&amp; octet_it);</code> a constructor that initializes the underlying octet_iterator with <code>octet_it</code> <code>octet_iterator base () const;</code> returns the underlying octet_iterator.
<code>uint32_t operator * () const;</code> decodes the utf-8 sequence the underlying octet_iterator is pointing to and returns the code point.
<code>bool operator == (const iterator&amp; rhs) const;</code> returns <code>true</code> if the two underlaying iterators are equal.
<code>bool operator != (const iterator&amp; rhs) const;</code> returns <code>true</code> if the two underlaying iterators are not equal.
<code>iterator&amp; operator ++ ();</code> the prefix increment - moves the iterator to the next UTF-8 encoded code point.
<code>iterator operator ++ (int);</code> the postfix increment - moves the iterator to the next UTF-8 encoded code point and returns the current one.
<code>iterator&amp; operator -- ();</code> the prefix decrement - moves the iterator to the previous UTF-8 encoded code point.
<code>iterator operator -- (int);</code> the postfix decrement - moves the iterator to the previous UTF-8 encoded code point and returns the current one.</p> <p>Example of use:</p> <div class="language-cpp extra-class"><pre class="language-cpp"><code><span class="token keyword">char</span><span class="token operator">*</span> threechars <span class="token operator">=</span> <span class="token string">&quot;\xf0\x90\x8d\x86\xe6\x97\xa5\xd1\x88&quot;</span><span class="token punctuation">;</span>
utf8<span class="token operator">::</span>unchecked<span class="token operator">::</span>iterator<span class="token operator">&lt;</span><span class="token keyword">char</span><span class="token operator">*</span><span class="token operator">&gt;</span> <span class="token function">un_it</span><span class="token punctuation">(</span>threechars<span class="token punctuation">)</span><span class="token punctuation">;</span>
utf8<span class="token operator">::</span>unchecked<span class="token operator">::</span>iterator<span class="token operator">&lt;</span><span class="token keyword">char</span><span class="token operator">*</span><span class="token operator">&gt;</span> un_it2 <span class="token operator">=</span> un_it<span class="token punctuation">;</span>
assert <span class="token punctuation">(</span>un_it2 <span class="token operator">==</span> un_it<span class="token punctuation">)</span><span class="token punctuation">;</span>
assert <span class="token punctuation">(</span><span class="token operator">*</span>un_it <span class="token operator">==</span> <span class="token number">0x10346</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
assert <span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token operator">++</span>un_it<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0x65e5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
assert <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token operator">*</span>un_it<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0x65e5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
assert <span class="token punctuation">(</span><span class="token operator">*</span>un_it <span class="token operator">==</span> <span class="token number">0x0448</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
assert <span class="token punctuation">(</span>un_it <span class="token operator">!=</span> un_it2<span class="token punctuation">)</span><span class="token punctuation">;</span>
utf8<span class="token operator">::</span><span class="token operator">::</span>unchecked<span class="token operator">::</span>iterator<span class="token operator">&lt;</span><span class="token keyword">char</span><span class="token operator">*</span><span class="token operator">&gt;</span> un_endit <span class="token punctuation">(</span>threechars <span class="token operator">+</span> <span class="token number">9</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
assert <span class="token punctuation">(</span><span class="token operator">++</span>un_it <span class="token operator">==</span> un_endit<span class="token punctuation">)</span><span class="token punctuation">;</span>
assert <span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token operator">--</span>un_it<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0x0448</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
assert <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token operator">*</span>un_it<span class="token operator">--</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0x0448</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
assert <span class="token punctuation">(</span><span class="token operator">*</span>un_it <span class="token operator">==</span> <span class="token number">0x65e5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
assert <span class="token punctuation">(</span><span class="token operator">--</span>un_it <span class="token operator">==</span> utf8<span class="token operator">::</span>unchecked<span class="token operator">::</span>iterator<span class="token operator">&lt;</span><span class="token keyword">char</span><span class="token operator">*</span><span class="token operator">&gt;</span><span class="token punctuation">(</span>threechars<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
assert <span class="token punctuation">(</span><span class="token operator">*</span>un_it <span class="token operator">==</span> <span class="token number">0x10346</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>This is an unchecked version of <code>utf8::iterator</code>. It is faster in many cases, but offers no validity or range checks.</p> <h2 id="points-of-interest"><a href="#points-of-interest" aria-hidden="true" class="header-anchor">#</a> Points of interest</h2> <h4 id="design-goals-and-decisions"><a href="#design-goals-and-decisions" aria-hidden="true" class="header-anchor">#</a> Design goals and decisions</h4> <p>The library was designed to be:</p> <ol><li>Generic: for better or worse, there are many C++ string classes out there, and the library should work with as many of them as possible.</li> <li>Portable: the library should be portable both accross different platforms and compilers. The only non-portable code is a small section that declares unsigned integers of different sizes: three typedefs. They can be changed by the users of the library if they don't match their platform. The default setting should work for Windows (both 32 and 64 bit), and most 32 bit and 64 bit Unix derivatives. At this point I don't plan to use any post C++03 features, so the library should work even with pretty old compilers.</li> <li>Lightweight: follow the &quot;pay only for what you use&quot; guideline.</li> <li>Unintrusive: avoid forcing any particular design or even programming style on the user. This is a library, not a framework.</li></ol> <h4 id="alternatives"><a href="#alternatives" aria-hidden="true" class="header-anchor">#</a> Alternatives</h4> <p>In case you want to look into other means of working with UTF-8 strings from C++, here is the list of solutions I am aware of:</p> <ol><li><a href="http://icu.sourceforge.net/" target="_blank" rel="noopener noreferrer">ICU Library<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>. It is very powerful, complete, feature-rich, mature, and widely used. Also big, intrusive, non-generic, and doesn't play well with the Standard Library. I definitelly recommend looking at ICU even if you don't plan to use it.</li> <li>C++11 language and library features. Still far from complete, and not easy to use.</li> <li><a href="http://www.gtkmm.org/gtkmm2/docs/tutorial/html/ch03s04.html" target="_blank" rel="noopener noreferrer">Glib::ustring<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>. A class specifically made to work with UTF-8 strings, and also feel like <code>std::string</code>. If you prefer to have yet another string class in your code, it may be worth a look. Be aware of the licensing issues, though.</li> <li>Platform dependent solutions: Windows and POSIX have functions to convert strings from one encoding to another. That is only a subset of what my library offers, but if that is all you need it may be good enough.</li></ol> <h2 id="links"><a href="#links" aria-hidden="true" class="header-anchor">#</a> Links</h2> <ol><li><a href="http://www.unicode.org/" target="_blank" rel="noopener noreferrer">The Unicode Consortium<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>.</li> <li><a href="http://icu.sourceforge.net/" target="_blank" rel="noopener noreferrer">ICU Library<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>.</li> <li><a href="http://en.wikipedia.org/wiki/UTF-8" target="_blank" rel="noopener noreferrer">UTF-8 at Wikipedia<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="http://www.cl.cam.ac.uk/~mgk25/unicode.html" target="_blank" rel="noopener noreferrer">UTF-8 and Unicode FAQ for Unix/Linux<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ol></div> <div class="page-edit"><!----> <!----></div> <!----> </div> <!----></div></div>
    <script src="/finegui/assets/js/app.3e08543b.js" defer></script><script src="/finegui/assets/js/254.bca2fd4e.js" defer></script>
  </body>
</html>
